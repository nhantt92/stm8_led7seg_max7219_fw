                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ANSI-C Compiler
                                      3 ; Version 3.6.0 #9615 (MINGW64)
                                      4 ;--------------------------------------------------------
                                      5 	.module ds1307
                                      6 	.optsdcc -mstm8
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _I2C_GetFlagStatus
                                     12 	.globl _I2C_CheckEvent
                                     13 	.globl _I2C_SendData
                                     14 	.globl _I2C_Send7bitAddress
                                     15 	.globl _I2C_ReceiveData
                                     16 	.globl _I2C_AcknowledgeConfig
                                     17 	.globl _I2C_GenerateSTOP
                                     18 	.globl _I2C_GenerateSTART
                                     19 	.globl _I2C_Cmd
                                     20 	.globl _I2C_Init
                                     21 	.globl _I2C_DeInit
                                     22 	.globl _CLK_GetClockFreq
                                     23 	.globl _CLK_PeripheralClockConfig
                                     24 	.globl _DS1307_Init
                                     25 	.globl _DS1307_write_time
                                     26 	.globl _DS1307_SetTime
                                     27 	.globl _DS1307_GetDateTime
                                     28 	.globl _DS1307_GetSeconds
                                     29 	.globl _DS1307_GetMinutes
                                     30 	.globl _DS1307_GetHours
                                     31 	.globl _DS1307_GetDay
                                     32 	.globl _DS1307_GetDate
                                     33 	.globl _DS1307_GetMonth
                                     34 	.globl _DS1307_GetYear
                                     35 	.globl _read_ds1307
                                     36 	.globl _BCD2BIN
                                     37 	.globl _BIN2BCD
                                     38 ;--------------------------------------------------------
                                     39 ; ram data
                                     40 ;--------------------------------------------------------
                                     41 	.area DATA
                                     42 ;--------------------------------------------------------
                                     43 ; ram data
                                     44 ;--------------------------------------------------------
                                     45 	.area INITIALIZED
                                     46 ;--------------------------------------------------------
                                     47 ; absolute external ram data
                                     48 ;--------------------------------------------------------
                                     49 	.area DABS (ABS)
                                     50 ;--------------------------------------------------------
                                     51 ; global & static initialisations
                                     52 ;--------------------------------------------------------
                                     53 	.area HOME
                                     54 	.area GSINIT
                                     55 	.area GSFINAL
                                     56 	.area GSINIT
                                     57 ;--------------------------------------------------------
                                     58 ; Home
                                     59 ;--------------------------------------------------------
                                     60 	.area HOME
                                     61 	.area HOME
                                     62 ;--------------------------------------------------------
                                     63 ; code
                                     64 ;--------------------------------------------------------
                                     65 	.area CODE
                                     66 ;	user/ds1307.c: 6: void DS1307_Init(void)
                                     67 ;	-----------------------------------------
                                     68 ;	 function DS1307_Init
                                     69 ;	-----------------------------------------
      0087AF                         70 _DS1307_Init:
      0087AF 88               [ 1]   71 	push	a
                                     72 ;	user/ds1307.c: 9: Input_Clock = CLK_GetClockFreq()/1000000;
      0087B0 CD 94 06         [ 4]   73 	call	_CLK_GetClockFreq
      0087B3 4B 40            [ 1]   74 	push	#0x40
      0087B5 4B 42            [ 1]   75 	push	#0x42
      0087B7 4B 0F            [ 1]   76 	push	#0x0f
      0087B9 4B 00            [ 1]   77 	push	#0x00
      0087BB 89               [ 2]   78 	pushw	x
      0087BC 90 89            [ 2]   79 	pushw	y
      0087BE CD 9B 16         [ 4]   80 	call	__divulong
      0087C1 5B 08            [ 2]   81 	addw	sp, #8
      0087C3 9F               [ 1]   82 	ld	a, xl
      0087C4 6B 01            [ 1]   83 	ld	(0x01, sp), a
                                     84 ;	user/ds1307.c: 10: I2C_DeInit();
      0087C6 CD 95 DA         [ 4]   85 	call	_I2C_DeInit
                                     86 ;	user/ds1307.c: 11: CLK_PeripheralClockConfig(CLK_PERIPHERAL_I2C, ENABLE);
      0087C9 4B 01            [ 1]   87 	push	#0x01
      0087CB 4B 00            [ 1]   88 	push	#0x00
      0087CD CD 92 25         [ 4]   89 	call	_CLK_PeripheralClockConfig
      0087D0 85               [ 2]   90 	popw	x
                                     91 ;	user/ds1307.c: 12: I2C_Cmd( ENABLE);
      0087D1 4B 01            [ 1]   92 	push	#0x01
      0087D3 CD 97 2D         [ 4]   93 	call	_I2C_Cmd
      0087D6 84               [ 1]   94 	pop	a
                                     95 ;	user/ds1307.c: 14: I2C_Init(DS1307_I2C_CLOCK, DS1307_I2C_ADDR, I2C_DUTYCYCLE_2, I2C_ACK_CURR, I2C_ADDMODE_7BIT,Input_Clock);
      0087D7 7B 01            [ 1]   96 	ld	a, (0x01, sp)
      0087D9 88               [ 1]   97 	push	a
      0087DA 4B 00            [ 1]   98 	push	#0x00
      0087DC 4B 01            [ 1]   99 	push	#0x01
      0087DE 4B 00            [ 1]  100 	push	#0x00
      0087E0 4B D0            [ 1]  101 	push	#0xd0
      0087E2 4B 00            [ 1]  102 	push	#0x00
      0087E4 4B 10            [ 1]  103 	push	#0x10
      0087E6 4B 27            [ 1]  104 	push	#0x27
      0087E8 5F               [ 1]  105 	clrw	x
      0087E9 89               [ 2]  106 	pushw	x
      0087EA CD 95 FF         [ 4]  107 	call	_I2C_Init
      0087ED 5B 0B            [ 2]  108 	addw	sp, #11
      0087EF 81               [ 4]  109 	ret
                                    110 ;	user/ds1307.c: 17: void DS1307_write_time(unsigned char hour1,unsigned char min1,unsigned char day1,unsigned char date1,unsigned char month1,unsigned char year1)
                                    111 ;	-----------------------------------------
                                    112 ;	 function DS1307_write_time
                                    113 ;	-----------------------------------------
      0087F0                        114 _DS1307_write_time:
      0087F0 52 15            [ 2]  115 	sub	sp, #21
                                    116 ;	user/ds1307.c: 20: data[0]=BIN2BCD(0x0);
      0087F2 96               [ 1]  117 	ldw	x, sp
      0087F3 5C               [ 2]  118 	incw	x
      0087F4 1F 0A            [ 2]  119 	ldw	(0x0a, sp), x
      0087F6 4B 00            [ 1]  120 	push	#0x00
      0087F8 CD 8C 91         [ 4]  121 	call	_BIN2BCD
      0087FB 5B 01            [ 2]  122 	addw	sp, #1
      0087FD 1E 0A            [ 2]  123 	ldw	x, (0x0a, sp)
      0087FF F7               [ 1]  124 	ld	(x), a
                                    125 ;	user/ds1307.c: 21: data[1]=BIN2BCD(min1);
      008800 1E 0A            [ 2]  126 	ldw	x, (0x0a, sp)
      008802 5C               [ 2]  127 	incw	x
      008803 1F 10            [ 2]  128 	ldw	(0x10, sp), x
      008805 7B 19            [ 1]  129 	ld	a, (0x19, sp)
      008807 88               [ 1]  130 	push	a
      008808 CD 8C 91         [ 4]  131 	call	_BIN2BCD
      00880B 5B 01            [ 2]  132 	addw	sp, #1
      00880D 1E 10            [ 2]  133 	ldw	x, (0x10, sp)
      00880F F7               [ 1]  134 	ld	(x), a
                                    135 ;	user/ds1307.c: 22: data[2]=BIN2BCD(hour1);
      008810 1E 0A            [ 2]  136 	ldw	x, (0x0a, sp)
      008812 5C               [ 2]  137 	incw	x
      008813 5C               [ 2]  138 	incw	x
      008814 1F 0C            [ 2]  139 	ldw	(0x0c, sp), x
      008816 7B 18            [ 1]  140 	ld	a, (0x18, sp)
      008818 88               [ 1]  141 	push	a
      008819 CD 8C 91         [ 4]  142 	call	_BIN2BCD
      00881C 5B 01            [ 2]  143 	addw	sp, #1
      00881E 1E 0C            [ 2]  144 	ldw	x, (0x0c, sp)
      008820 F7               [ 1]  145 	ld	(x), a
                                    146 ;	user/ds1307.c: 23: data[3]=BIN2BCD(day1);
      008821 1E 0A            [ 2]  147 	ldw	x, (0x0a, sp)
      008823 1C 00 03         [ 2]  148 	addw	x, #0x0003
      008826 1F 08            [ 2]  149 	ldw	(0x08, sp), x
      008828 7B 1A            [ 1]  150 	ld	a, (0x1a, sp)
      00882A 88               [ 1]  151 	push	a
      00882B CD 8C 91         [ 4]  152 	call	_BIN2BCD
      00882E 5B 01            [ 2]  153 	addw	sp, #1
      008830 1E 08            [ 2]  154 	ldw	x, (0x08, sp)
      008832 F7               [ 1]  155 	ld	(x), a
                                    156 ;	user/ds1307.c: 24: data[4]=BIN2BCD(date1);
      008833 1E 0A            [ 2]  157 	ldw	x, (0x0a, sp)
      008835 1C 00 04         [ 2]  158 	addw	x, #0x0004
      008838 1F 12            [ 2]  159 	ldw	(0x12, sp), x
      00883A 7B 1B            [ 1]  160 	ld	a, (0x1b, sp)
      00883C 88               [ 1]  161 	push	a
      00883D CD 8C 91         [ 4]  162 	call	_BIN2BCD
      008840 5B 01            [ 2]  163 	addw	sp, #1
      008842 1E 12            [ 2]  164 	ldw	x, (0x12, sp)
      008844 F7               [ 1]  165 	ld	(x), a
                                    166 ;	user/ds1307.c: 25: data[5]=BIN2BCD(month1);
      008845 1E 0A            [ 2]  167 	ldw	x, (0x0a, sp)
      008847 1C 00 05         [ 2]  168 	addw	x, #0x0005
      00884A 1F 0E            [ 2]  169 	ldw	(0x0e, sp), x
      00884C 7B 1C            [ 1]  170 	ld	a, (0x1c, sp)
      00884E 88               [ 1]  171 	push	a
      00884F CD 8C 91         [ 4]  172 	call	_BIN2BCD
      008852 5B 01            [ 2]  173 	addw	sp, #1
      008854 1E 0E            [ 2]  174 	ldw	x, (0x0e, sp)
      008856 F7               [ 1]  175 	ld	(x), a
                                    176 ;	user/ds1307.c: 26: data[6]=BIN2BCD(year1);
      008857 1E 0A            [ 2]  177 	ldw	x, (0x0a, sp)
      008859 1C 00 06         [ 2]  178 	addw	x, #0x0006
      00885C 1F 14            [ 2]  179 	ldw	(0x14, sp), x
      00885E 7B 1D            [ 1]  180 	ld	a, (0x1d, sp)
      008860 88               [ 1]  181 	push	a
      008861 CD 8C 91         [ 4]  182 	call	_BIN2BCD
      008864 5B 01            [ 2]  183 	addw	sp, #1
      008866 1E 14            [ 2]  184 	ldw	x, (0x14, sp)
      008868 F7               [ 1]  185 	ld	(x), a
                                    186 ;	user/ds1307.c: 28: while(I2C_GetFlagStatus( I2C_FLAG_BUSBUSY)==SET);
      008869                        187 00101$:
      008869 4B 02            [ 1]  188 	push	#0x02
      00886B 4B 03            [ 1]  189 	push	#0x03
      00886D CD 98 84         [ 4]  190 	call	_I2C_GetFlagStatus
      008870 85               [ 2]  191 	popw	x
      008871 A1 01            [ 1]  192 	cp	a, #0x01
      008873 27 F4            [ 1]  193 	jreq	00101$
                                    194 ;	user/ds1307.c: 29: I2C_GenerateSTART(ENABLE);
      008875 4B 01            [ 1]  195 	push	#0x01
      008877 CD 97 4F         [ 4]  196 	call	_I2C_GenerateSTART
      00887A 84               [ 1]  197 	pop	a
                                    198 ;	user/ds1307.c: 32: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      00887B                        199 00104$:
      00887B 4B 01            [ 1]  200 	push	#0x01
      00887D 4B 03            [ 1]  201 	push	#0x03
      00887F CD 98 09         [ 4]  202 	call	_I2C_CheckEvent
      008882 85               [ 2]  203 	popw	x
      008883 4D               [ 1]  204 	tnz	a
      008884 27 F5            [ 1]  205 	jreq	00104$
                                    206 ;	user/ds1307.c: 35: I2C_Send7bitAddress(DS1307_ADDR_WRITE,I2C_DIRECTION_TX);
      008886 4B 00            [ 1]  207 	push	#0x00
      008888 4B D0            [ 1]  208 	push	#0xd0
      00888A CD 97 F3         [ 4]  209 	call	_I2C_Send7bitAddress
      00888D 85               [ 2]  210 	popw	x
                                    211 ;	user/ds1307.c: 38: while(!I2C_CheckEvent( I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));
      00888E                        212 00107$:
      00888E 4B 82            [ 1]  213 	push	#0x82
      008890 4B 07            [ 1]  214 	push	#0x07
      008892 CD 98 09         [ 4]  215 	call	_I2C_CheckEvent
      008895 85               [ 2]  216 	popw	x
      008896 4D               [ 1]  217 	tnz	a
      008897 27 F5            [ 1]  218 	jreq	00107$
                                    219 ;	user/ds1307.c: 42: I2C_SendData( 0x01);
      008899 4B 01            [ 1]  220 	push	#0x01
      00889B CD 98 02         [ 4]  221 	call	_I2C_SendData
      00889E 84               [ 1]  222 	pop	a
                                    223 ;	user/ds1307.c: 45: while(!I2C_CheckEvent( I2C_EVENT_MASTER_BYTE_TRANSMITTED));
      00889F                        224 00110$:
      00889F 4B 84            [ 1]  225 	push	#0x84
      0088A1 4B 07            [ 1]  226 	push	#0x07
      0088A3 CD 98 09         [ 4]  227 	call	_I2C_CheckEvent
      0088A6 85               [ 2]  228 	popw	x
      0088A7 4D               [ 1]  229 	tnz	a
      0088A8 27 F5            [ 1]  230 	jreq	00110$
                                    231 ;	user/ds1307.c: 49: I2C_SendData( data[1]);
      0088AA 1E 10            [ 2]  232 	ldw	x, (0x10, sp)
      0088AC F6               [ 1]  233 	ld	a, (x)
      0088AD 88               [ 1]  234 	push	a
      0088AE CD 98 02         [ 4]  235 	call	_I2C_SendData
      0088B1 84               [ 1]  236 	pop	a
                                    237 ;	user/ds1307.c: 52: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0088B2                        238 00113$:
      0088B2 4B 04            [ 1]  239 	push	#0x04
      0088B4 4B 01            [ 1]  240 	push	#0x01
      0088B6 CD 98 84         [ 4]  241 	call	_I2C_GetFlagStatus
      0088B9 85               [ 2]  242 	popw	x
      0088BA 4D               [ 1]  243 	tnz	a
      0088BB 27 F5            [ 1]  244 	jreq	00113$
                                    245 ;	user/ds1307.c: 55: I2C_SendData( data[2]);
      0088BD 1E 0C            [ 2]  246 	ldw	x, (0x0c, sp)
      0088BF F6               [ 1]  247 	ld	a, (x)
      0088C0 88               [ 1]  248 	push	a
      0088C1 CD 98 02         [ 4]  249 	call	_I2C_SendData
      0088C4 84               [ 1]  250 	pop	a
                                    251 ;	user/ds1307.c: 58: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0088C5                        252 00116$:
      0088C5 4B 04            [ 1]  253 	push	#0x04
      0088C7 4B 01            [ 1]  254 	push	#0x01
      0088C9 CD 98 84         [ 4]  255 	call	_I2C_GetFlagStatus
      0088CC 85               [ 2]  256 	popw	x
      0088CD 4D               [ 1]  257 	tnz	a
      0088CE 27 F5            [ 1]  258 	jreq	00116$
                                    259 ;	user/ds1307.c: 61: I2C_SendData( data[3]);
      0088D0 1E 08            [ 2]  260 	ldw	x, (0x08, sp)
      0088D2 F6               [ 1]  261 	ld	a, (x)
      0088D3 88               [ 1]  262 	push	a
      0088D4 CD 98 02         [ 4]  263 	call	_I2C_SendData
      0088D7 84               [ 1]  264 	pop	a
                                    265 ;	user/ds1307.c: 64: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0088D8                        266 00119$:
      0088D8 4B 04            [ 1]  267 	push	#0x04
      0088DA 4B 01            [ 1]  268 	push	#0x01
      0088DC CD 98 84         [ 4]  269 	call	_I2C_GetFlagStatus
      0088DF 85               [ 2]  270 	popw	x
      0088E0 4D               [ 1]  271 	tnz	a
      0088E1 27 F5            [ 1]  272 	jreq	00119$
                                    273 ;	user/ds1307.c: 67: I2C_SendData( data[4]);
      0088E3 1E 12            [ 2]  274 	ldw	x, (0x12, sp)
      0088E5 F6               [ 1]  275 	ld	a, (x)
      0088E6 88               [ 1]  276 	push	a
      0088E7 CD 98 02         [ 4]  277 	call	_I2C_SendData
      0088EA 84               [ 1]  278 	pop	a
                                    279 ;	user/ds1307.c: 70: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0088EB                        280 00122$:
      0088EB 4B 04            [ 1]  281 	push	#0x04
      0088ED 4B 01            [ 1]  282 	push	#0x01
      0088EF CD 98 84         [ 4]  283 	call	_I2C_GetFlagStatus
      0088F2 85               [ 2]  284 	popw	x
      0088F3 4D               [ 1]  285 	tnz	a
      0088F4 27 F5            [ 1]  286 	jreq	00122$
                                    287 ;	user/ds1307.c: 73: I2C_SendData( data[5]);
      0088F6 1E 0E            [ 2]  288 	ldw	x, (0x0e, sp)
      0088F8 F6               [ 1]  289 	ld	a, (x)
      0088F9 88               [ 1]  290 	push	a
      0088FA CD 98 02         [ 4]  291 	call	_I2C_SendData
      0088FD 84               [ 1]  292 	pop	a
                                    293 ;	user/ds1307.c: 76: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0088FE                        294 00125$:
      0088FE 4B 04            [ 1]  295 	push	#0x04
      008900 4B 01            [ 1]  296 	push	#0x01
      008902 CD 98 84         [ 4]  297 	call	_I2C_GetFlagStatus
      008905 85               [ 2]  298 	popw	x
      008906 4D               [ 1]  299 	tnz	a
      008907 27 F5            [ 1]  300 	jreq	00125$
                                    301 ;	user/ds1307.c: 79: I2C_SendData( data[6]);
      008909 1E 14            [ 2]  302 	ldw	x, (0x14, sp)
      00890B F6               [ 1]  303 	ld	a, (x)
      00890C 88               [ 1]  304 	push	a
      00890D CD 98 02         [ 4]  305 	call	_I2C_SendData
      008910 84               [ 1]  306 	pop	a
                                    307 ;	user/ds1307.c: 82: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008911                        308 00128$:
      008911 4B 04            [ 1]  309 	push	#0x04
      008913 4B 01            [ 1]  310 	push	#0x01
      008915 CD 98 84         [ 4]  311 	call	_I2C_GetFlagStatus
      008918 85               [ 2]  312 	popw	x
      008919 4D               [ 1]  313 	tnz	a
      00891A 27 F5            [ 1]  314 	jreq	00128$
                                    315 ;	user/ds1307.c: 85: I2C_GenerateSTOP(ENABLE);
      00891C 4B 01            [ 1]  316 	push	#0x01
      00891E CD 97 5D         [ 4]  317 	call	_I2C_GenerateSTOP
      008921 84               [ 1]  318 	pop	a
                                    319 ;	user/ds1307.c: 88: I2C->SR1;		I2C->SR3;
      008922 AE 52 17         [ 2]  320 	ldw	x, #0x5217
      008925 F6               [ 1]  321 	ld	a, (x)
      008926 AE 52 19         [ 2]  322 	ldw	x, #0x5219
      008929 F6               [ 1]  323 	ld	a, (x)
      00892A 5B 15            [ 2]  324 	addw	sp, #21
      00892C 81               [ 4]  325 	ret
                                    326 ;	user/ds1307.c: 92: void DS1307_SetTime(DS1307_Time_t* time)
                                    327 ;	-----------------------------------------
                                    328 ;	 function DS1307_SetTime
                                    329 ;	-----------------------------------------
      00892D                        330 _DS1307_SetTime:
      00892D 52 17            [ 2]  331 	sub	sp, #23
                                    332 ;	user/ds1307.c: 95: data[0]=BIN2BCD(time->seconds);
      00892F 96               [ 1]  333 	ldw	x, sp
      008930 5C               [ 2]  334 	incw	x
      008931 1F 0C            [ 2]  335 	ldw	(0x0c, sp), x
      008933 16 1A            [ 2]  336 	ldw	y, (0x1a, sp)
      008935 17 14            [ 2]  337 	ldw	(0x14, sp), y
      008937 1E 14            [ 2]  338 	ldw	x, (0x14, sp)
      008939 F6               [ 1]  339 	ld	a, (x)
      00893A 88               [ 1]  340 	push	a
      00893B CD 8C 91         [ 4]  341 	call	_BIN2BCD
      00893E 5B 01            [ 2]  342 	addw	sp, #1
      008940 1E 0C            [ 2]  343 	ldw	x, (0x0c, sp)
      008942 F7               [ 1]  344 	ld	(x), a
                                    345 ;	user/ds1307.c: 96: data[1]=BIN2BCD(time->minutes);
      008943 1E 0C            [ 2]  346 	ldw	x, (0x0c, sp)
      008945 5C               [ 2]  347 	incw	x
      008946 1F 12            [ 2]  348 	ldw	(0x12, sp), x
      008948 1E 14            [ 2]  349 	ldw	x, (0x14, sp)
      00894A E6 01            [ 1]  350 	ld	a, (0x1, x)
      00894C 88               [ 1]  351 	push	a
      00894D CD 8C 91         [ 4]  352 	call	_BIN2BCD
      008950 5B 01            [ 2]  353 	addw	sp, #1
      008952 1E 12            [ 2]  354 	ldw	x, (0x12, sp)
      008954 F7               [ 1]  355 	ld	(x), a
                                    356 ;	user/ds1307.c: 97: data[2]=BIN2BCD(time->hours);
      008955 1E 0C            [ 2]  357 	ldw	x, (0x0c, sp)
      008957 5C               [ 2]  358 	incw	x
      008958 5C               [ 2]  359 	incw	x
      008959 1F 0E            [ 2]  360 	ldw	(0x0e, sp), x
      00895B 1E 14            [ 2]  361 	ldw	x, (0x14, sp)
      00895D E6 02            [ 1]  362 	ld	a, (0x2, x)
      00895F 88               [ 1]  363 	push	a
      008960 CD 8C 91         [ 4]  364 	call	_BIN2BCD
      008963 5B 01            [ 2]  365 	addw	sp, #1
      008965 1E 0E            [ 2]  366 	ldw	x, (0x0e, sp)
      008967 F7               [ 1]  367 	ld	(x), a
                                    368 ;	user/ds1307.c: 98: data[3]=BIN2BCD(time->day);
      008968 1E 0C            [ 2]  369 	ldw	x, (0x0c, sp)
      00896A 1C 00 03         [ 2]  370 	addw	x, #0x0003
      00896D 1F 16            [ 2]  371 	ldw	(0x16, sp), x
      00896F 1E 14            [ 2]  372 	ldw	x, (0x14, sp)
      008971 E6 03            [ 1]  373 	ld	a, (0x3, x)
      008973 88               [ 1]  374 	push	a
      008974 CD 8C 91         [ 4]  375 	call	_BIN2BCD
      008977 5B 01            [ 2]  376 	addw	sp, #1
      008979 1E 16            [ 2]  377 	ldw	x, (0x16, sp)
      00897B F7               [ 1]  378 	ld	(x), a
                                    379 ;	user/ds1307.c: 99: data[4]=BIN2BCD(time->date);
      00897C 1E 0C            [ 2]  380 	ldw	x, (0x0c, sp)
      00897E 1C 00 04         [ 2]  381 	addw	x, #0x0004
      008981 1F 0A            [ 2]  382 	ldw	(0x0a, sp), x
      008983 1E 14            [ 2]  383 	ldw	x, (0x14, sp)
      008985 E6 04            [ 1]  384 	ld	a, (0x4, x)
      008987 88               [ 1]  385 	push	a
      008988 CD 8C 91         [ 4]  386 	call	_BIN2BCD
      00898B 5B 01            [ 2]  387 	addw	sp, #1
      00898D 1E 0A            [ 2]  388 	ldw	x, (0x0a, sp)
      00898F F7               [ 1]  389 	ld	(x), a
                                    390 ;	user/ds1307.c: 100: data[5]=BIN2BCD(time->month);
      008990 1E 0C            [ 2]  391 	ldw	x, (0x0c, sp)
      008992 1C 00 05         [ 2]  392 	addw	x, #0x0005
      008995 1F 10            [ 2]  393 	ldw	(0x10, sp), x
      008997 1E 14            [ 2]  394 	ldw	x, (0x14, sp)
      008999 E6 05            [ 1]  395 	ld	a, (0x5, x)
      00899B 88               [ 1]  396 	push	a
      00899C CD 8C 91         [ 4]  397 	call	_BIN2BCD
      00899F 5B 01            [ 2]  398 	addw	sp, #1
      0089A1 1E 10            [ 2]  399 	ldw	x, (0x10, sp)
      0089A3 F7               [ 1]  400 	ld	(x), a
                                    401 ;	user/ds1307.c: 101: data[6]=BIN2BCD(time->year);
      0089A4 1E 0C            [ 2]  402 	ldw	x, (0x0c, sp)
      0089A6 1C 00 06         [ 2]  403 	addw	x, #0x0006
      0089A9 1F 08            [ 2]  404 	ldw	(0x08, sp), x
      0089AB 1E 14            [ 2]  405 	ldw	x, (0x14, sp)
      0089AD E6 06            [ 1]  406 	ld	a, (0x6, x)
      0089AF 88               [ 1]  407 	push	a
      0089B0 CD 8C 91         [ 4]  408 	call	_BIN2BCD
      0089B3 5B 01            [ 2]  409 	addw	sp, #1
      0089B5 1E 08            [ 2]  410 	ldw	x, (0x08, sp)
      0089B7 F7               [ 1]  411 	ld	(x), a
                                    412 ;	user/ds1307.c: 103: while(I2C_GetFlagStatus( I2C_FLAG_BUSBUSY)==SET);
      0089B8                        413 00101$:
      0089B8 4B 02            [ 1]  414 	push	#0x02
      0089BA 4B 03            [ 1]  415 	push	#0x03
      0089BC CD 98 84         [ 4]  416 	call	_I2C_GetFlagStatus
      0089BF 85               [ 2]  417 	popw	x
      0089C0 A1 01            [ 1]  418 	cp	a, #0x01
      0089C2 27 F4            [ 1]  419 	jreq	00101$
                                    420 ;	user/ds1307.c: 104: I2C_GenerateSTART(ENABLE);
      0089C4 4B 01            [ 1]  421 	push	#0x01
      0089C6 CD 97 4F         [ 4]  422 	call	_I2C_GenerateSTART
      0089C9 84               [ 1]  423 	pop	a
                                    424 ;	user/ds1307.c: 107: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      0089CA                        425 00104$:
      0089CA 4B 01            [ 1]  426 	push	#0x01
      0089CC 4B 03            [ 1]  427 	push	#0x03
      0089CE CD 98 09         [ 4]  428 	call	_I2C_CheckEvent
      0089D1 85               [ 2]  429 	popw	x
      0089D2 4D               [ 1]  430 	tnz	a
      0089D3 27 F5            [ 1]  431 	jreq	00104$
                                    432 ;	user/ds1307.c: 110: I2C_Send7bitAddress((uint8_t)DS1307_ADDR_WRITE,I2C_DIRECTION_TX);
      0089D5 4B 00            [ 1]  433 	push	#0x00
      0089D7 4B D0            [ 1]  434 	push	#0xd0
      0089D9 CD 97 F3         [ 4]  435 	call	_I2C_Send7bitAddress
      0089DC 85               [ 2]  436 	popw	x
                                    437 ;	user/ds1307.c: 113: while(!I2C_CheckEvent( I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));
      0089DD                        438 00107$:
      0089DD 4B 82            [ 1]  439 	push	#0x82
      0089DF 4B 07            [ 1]  440 	push	#0x07
      0089E1 CD 98 09         [ 4]  441 	call	_I2C_CheckEvent
      0089E4 85               [ 2]  442 	popw	x
      0089E5 4D               [ 1]  443 	tnz	a
      0089E6 27 F5            [ 1]  444 	jreq	00107$
                                    445 ;	user/ds1307.c: 116: I2C_SendData( 0x01);
      0089E8 4B 01            [ 1]  446 	push	#0x01
      0089EA CD 98 02         [ 4]  447 	call	_I2C_SendData
      0089ED 84               [ 1]  448 	pop	a
                                    449 ;	user/ds1307.c: 119: while(!I2C_CheckEvent( I2C_EVENT_MASTER_BYTE_TRANSMITTED));
      0089EE                        450 00110$:
      0089EE 4B 84            [ 1]  451 	push	#0x84
      0089F0 4B 07            [ 1]  452 	push	#0x07
      0089F2 CD 98 09         [ 4]  453 	call	_I2C_CheckEvent
      0089F5 85               [ 2]  454 	popw	x
      0089F6 4D               [ 1]  455 	tnz	a
      0089F7 27 F5            [ 1]  456 	jreq	00110$
                                    457 ;	user/ds1307.c: 123: I2C_SendData( data[1]);
      0089F9 1E 12            [ 2]  458 	ldw	x, (0x12, sp)
      0089FB F6               [ 1]  459 	ld	a, (x)
      0089FC 88               [ 1]  460 	push	a
      0089FD CD 98 02         [ 4]  461 	call	_I2C_SendData
      008A00 84               [ 1]  462 	pop	a
                                    463 ;	user/ds1307.c: 126: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008A01                        464 00113$:
      008A01 4B 04            [ 1]  465 	push	#0x04
      008A03 4B 01            [ 1]  466 	push	#0x01
      008A05 CD 98 84         [ 4]  467 	call	_I2C_GetFlagStatus
      008A08 85               [ 2]  468 	popw	x
      008A09 4D               [ 1]  469 	tnz	a
      008A0A 27 F5            [ 1]  470 	jreq	00113$
                                    471 ;	user/ds1307.c: 129: I2C_SendData( data[2]);
      008A0C 1E 0E            [ 2]  472 	ldw	x, (0x0e, sp)
      008A0E F6               [ 1]  473 	ld	a, (x)
      008A0F 88               [ 1]  474 	push	a
      008A10 CD 98 02         [ 4]  475 	call	_I2C_SendData
      008A13 84               [ 1]  476 	pop	a
                                    477 ;	user/ds1307.c: 132: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008A14                        478 00116$:
      008A14 4B 04            [ 1]  479 	push	#0x04
      008A16 4B 01            [ 1]  480 	push	#0x01
      008A18 CD 98 84         [ 4]  481 	call	_I2C_GetFlagStatus
      008A1B 85               [ 2]  482 	popw	x
      008A1C 4D               [ 1]  483 	tnz	a
      008A1D 27 F5            [ 1]  484 	jreq	00116$
                                    485 ;	user/ds1307.c: 135: I2C_SendData( data[3]);
      008A1F 1E 16            [ 2]  486 	ldw	x, (0x16, sp)
      008A21 F6               [ 1]  487 	ld	a, (x)
      008A22 88               [ 1]  488 	push	a
      008A23 CD 98 02         [ 4]  489 	call	_I2C_SendData
      008A26 84               [ 1]  490 	pop	a
                                    491 ;	user/ds1307.c: 138: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008A27                        492 00119$:
      008A27 4B 04            [ 1]  493 	push	#0x04
      008A29 4B 01            [ 1]  494 	push	#0x01
      008A2B CD 98 84         [ 4]  495 	call	_I2C_GetFlagStatus
      008A2E 85               [ 2]  496 	popw	x
      008A2F 4D               [ 1]  497 	tnz	a
      008A30 27 F5            [ 1]  498 	jreq	00119$
                                    499 ;	user/ds1307.c: 141: I2C_SendData( data[4]);
      008A32 1E 0A            [ 2]  500 	ldw	x, (0x0a, sp)
      008A34 F6               [ 1]  501 	ld	a, (x)
      008A35 88               [ 1]  502 	push	a
      008A36 CD 98 02         [ 4]  503 	call	_I2C_SendData
      008A39 84               [ 1]  504 	pop	a
                                    505 ;	user/ds1307.c: 144: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008A3A                        506 00122$:
      008A3A 4B 04            [ 1]  507 	push	#0x04
      008A3C 4B 01            [ 1]  508 	push	#0x01
      008A3E CD 98 84         [ 4]  509 	call	_I2C_GetFlagStatus
      008A41 85               [ 2]  510 	popw	x
      008A42 4D               [ 1]  511 	tnz	a
      008A43 27 F5            [ 1]  512 	jreq	00122$
                                    513 ;	user/ds1307.c: 147: I2C_SendData( data[5]);
      008A45 1E 10            [ 2]  514 	ldw	x, (0x10, sp)
      008A47 F6               [ 1]  515 	ld	a, (x)
      008A48 88               [ 1]  516 	push	a
      008A49 CD 98 02         [ 4]  517 	call	_I2C_SendData
      008A4C 84               [ 1]  518 	pop	a
                                    519 ;	user/ds1307.c: 150: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008A4D                        520 00125$:
      008A4D 4B 04            [ 1]  521 	push	#0x04
      008A4F 4B 01            [ 1]  522 	push	#0x01
      008A51 CD 98 84         [ 4]  523 	call	_I2C_GetFlagStatus
      008A54 85               [ 2]  524 	popw	x
      008A55 4D               [ 1]  525 	tnz	a
      008A56 27 F5            [ 1]  526 	jreq	00125$
                                    527 ;	user/ds1307.c: 153: I2C_SendData( data[6]);
      008A58 1E 08            [ 2]  528 	ldw	x, (0x08, sp)
      008A5A F6               [ 1]  529 	ld	a, (x)
      008A5B 88               [ 1]  530 	push	a
      008A5C CD 98 02         [ 4]  531 	call	_I2C_SendData
      008A5F 84               [ 1]  532 	pop	a
                                    533 ;	user/ds1307.c: 156: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008A60                        534 00128$:
      008A60 4B 04            [ 1]  535 	push	#0x04
      008A62 4B 01            [ 1]  536 	push	#0x01
      008A64 CD 98 84         [ 4]  537 	call	_I2C_GetFlagStatus
      008A67 85               [ 2]  538 	popw	x
      008A68 4D               [ 1]  539 	tnz	a
      008A69 27 F5            [ 1]  540 	jreq	00128$
                                    541 ;	user/ds1307.c: 159: I2C_GenerateSTOP(ENABLE);
      008A6B 4B 01            [ 1]  542 	push	#0x01
      008A6D CD 97 5D         [ 4]  543 	call	_I2C_GenerateSTOP
      008A70 84               [ 1]  544 	pop	a
                                    545 ;	user/ds1307.c: 162: I2C->SR1;        I2C->SR3;
      008A71 AE 52 17         [ 2]  546 	ldw	x, #0x5217
      008A74 F6               [ 1]  547 	ld	a, (x)
      008A75 AE 52 19         [ 2]  548 	ldw	x, #0x5219
      008A78 F6               [ 1]  549 	ld	a, (x)
      008A79 5B 17            [ 2]  550 	addw	sp, #23
      008A7B 81               [ 4]  551 	ret
                                    552 ;	user/ds1307.c: 165: void DS1307_GetDateTime(DS1307_Time_t* time) {
                                    553 ;	-----------------------------------------
                                    554 ;	 function DS1307_GetDateTime
                                    555 ;	-----------------------------------------
      008A7C                        556 _DS1307_GetDateTime:
      008A7C 52 18            [ 2]  557 	sub	sp, #24
                                    558 ;	user/ds1307.c: 168: for(i=0;i<8;i++)
      008A7E 96               [ 1]  559 	ldw	x, sp
      008A7F 5C               [ 2]  560 	incw	x
      008A80 1F 15            [ 2]  561 	ldw	(0x15, sp), x
      008A82 0F 08            [ 1]  562 	clr	(0x08, sp)
      008A84                        563 00105$:
                                    564 ;	user/ds1307.c: 170: data[i]=read_ds1307(i);
      008A84 5F               [ 1]  565 	clrw	x
      008A85 7B 08            [ 1]  566 	ld	a, (0x08, sp)
      008A87 97               [ 1]  567 	ld	xl, a
      008A88 72 FB 15         [ 2]  568 	addw	x, (0x15, sp)
      008A8B 89               [ 2]  569 	pushw	x
      008A8C 7B 0A            [ 1]  570 	ld	a, (0x0a, sp)
      008A8E 88               [ 1]  571 	push	a
      008A8F CD 8B DB         [ 4]  572 	call	_read_ds1307
      008A92 5B 01            [ 2]  573 	addw	sp, #1
      008A94 85               [ 2]  574 	popw	x
      008A95 F7               [ 1]  575 	ld	(x), a
                                    576 ;	user/ds1307.c: 168: for(i=0;i<8;i++)
      008A96 0C 08            [ 1]  577 	inc	(0x08, sp)
      008A98 7B 08            [ 1]  578 	ld	a, (0x08, sp)
      008A9A A1 08            [ 1]  579 	cp	a, #0x08
      008A9C 25 E6            [ 1]  580 	jrc	00105$
                                    581 ;	user/ds1307.c: 173: time->seconds = BCD2BIN(data[0]&=0x7F);
      008A9E 16 1B            [ 2]  582 	ldw	y, (0x1b, sp)
      008AA0 17 0F            [ 2]  583 	ldw	(0x0f, sp), y
      008AA2 1E 15            [ 2]  584 	ldw	x, (0x15, sp)
      008AA4 F6               [ 1]  585 	ld	a, (x)
      008AA5 A4 7F            [ 1]  586 	and	a, #0x7f
      008AA7 1E 15            [ 2]  587 	ldw	x, (0x15, sp)
      008AA9 F7               [ 1]  588 	ld	(x), a
      008AAA 88               [ 1]  589 	push	a
      008AAB CD 8C 79         [ 4]  590 	call	_BCD2BIN
      008AAE 5B 01            [ 2]  591 	addw	sp, #1
      008AB0 1E 0F            [ 2]  592 	ldw	x, (0x0f, sp)
      008AB2 F7               [ 1]  593 	ld	(x), a
                                    594 ;	user/ds1307.c: 175: time->minutes = BCD2BIN(data[1]&=0x7F);
      008AB3 1E 0F            [ 2]  595 	ldw	x, (0x0f, sp)
      008AB5 5C               [ 2]  596 	incw	x
      008AB6 1F 17            [ 2]  597 	ldw	(0x17, sp), x
      008AB8 1E 15            [ 2]  598 	ldw	x, (0x15, sp)
      008ABA 5C               [ 2]  599 	incw	x
      008ABB F6               [ 1]  600 	ld	a, (x)
      008ABC A4 7F            [ 1]  601 	and	a, #0x7f
      008ABE F7               [ 1]  602 	ld	(x), a
      008ABF 89               [ 2]  603 	pushw	x
      008AC0 88               [ 1]  604 	push	a
      008AC1 CD 8C 79         [ 4]  605 	call	_BCD2BIN
      008AC4 5B 01            [ 2]  606 	addw	sp, #1
      008AC6 85               [ 2]  607 	popw	x
      008AC7 16 17            [ 2]  608 	ldw	y, (0x17, sp)
      008AC9 90 F7            [ 1]  609 	ld	(y), a
                                    610 ;	user/ds1307.c: 177: if((data[1]&0x40)!=0)    time->hours=BCD2BIN(data[2]&=0x1F);
      008ACB F6               [ 1]  611 	ld	a, (x)
      008ACC 90 97            [ 1]  612 	ld	yl, a
      008ACE 1E 0F            [ 2]  613 	ldw	x, (0x0f, sp)
      008AD0 5C               [ 2]  614 	incw	x
      008AD1 5C               [ 2]  615 	incw	x
      008AD2 1F 09            [ 2]  616 	ldw	(0x09, sp), x
      008AD4 1E 15            [ 2]  617 	ldw	x, (0x15, sp)
      008AD6 5C               [ 2]  618 	incw	x
      008AD7 5C               [ 2]  619 	incw	x
      008AD8 F6               [ 1]  620 	ld	a, (x)
      008AD9 88               [ 1]  621 	push	a
      008ADA 90 9F            [ 1]  622 	ld	a, yl
      008ADC A5 40            [ 1]  623 	bcp	a, #0x40
      008ADE 84               [ 1]  624 	pop	a
      008ADF 27 0E            [ 1]  625 	jreq	00103$
      008AE1 A4 1F            [ 1]  626 	and	a, #0x1f
      008AE3 F7               [ 1]  627 	ld	(x), a
      008AE4 88               [ 1]  628 	push	a
      008AE5 CD 8C 79         [ 4]  629 	call	_BCD2BIN
      008AE8 5B 01            [ 2]  630 	addw	sp, #1
      008AEA 1E 09            [ 2]  631 	ldw	x, (0x09, sp)
      008AEC F7               [ 1]  632 	ld	(x), a
      008AED 20 0C            [ 2]  633 	jra	00104$
      008AEF                        634 00103$:
                                    635 ;	user/ds1307.c: 178: else time->hours=BCD2BIN(data[2]&=0x3F);
      008AEF A4 3F            [ 1]  636 	and	a, #0x3f
      008AF1 F7               [ 1]  637 	ld	(x), a
      008AF2 88               [ 1]  638 	push	a
      008AF3 CD 8C 79         [ 4]  639 	call	_BCD2BIN
      008AF6 5B 01            [ 2]  640 	addw	sp, #1
      008AF8 1E 09            [ 2]  641 	ldw	x, (0x09, sp)
      008AFA F7               [ 1]  642 	ld	(x), a
      008AFB                        643 00104$:
                                    644 ;	user/ds1307.c: 180: time->day = BCD2BIN(data[3]&=0x07);
      008AFB 1E 0F            [ 2]  645 	ldw	x, (0x0f, sp)
      008AFD 1C 00 03         [ 2]  646 	addw	x, #0x0003
      008B00 1F 13            [ 2]  647 	ldw	(0x13, sp), x
      008B02 1E 15            [ 2]  648 	ldw	x, (0x15, sp)
      008B04 1C 00 03         [ 2]  649 	addw	x, #0x0003
      008B07 F6               [ 1]  650 	ld	a, (x)
      008B08 A4 07            [ 1]  651 	and	a, #0x07
      008B0A F7               [ 1]  652 	ld	(x), a
      008B0B 88               [ 1]  653 	push	a
      008B0C CD 8C 79         [ 4]  654 	call	_BCD2BIN
      008B0F 5B 01            [ 2]  655 	addw	sp, #1
      008B11 1E 13            [ 2]  656 	ldw	x, (0x13, sp)
      008B13 F7               [ 1]  657 	ld	(x), a
                                    658 ;	user/ds1307.c: 181: time->date = BCD2BIN(data[4]&=0x3F);
      008B14 1E 0F            [ 2]  659 	ldw	x, (0x0f, sp)
      008B16 1C 00 04         [ 2]  660 	addw	x, #0x0004
      008B19 1F 0D            [ 2]  661 	ldw	(0x0d, sp), x
      008B1B 1E 15            [ 2]  662 	ldw	x, (0x15, sp)
      008B1D 1C 00 04         [ 2]  663 	addw	x, #0x0004
      008B20 F6               [ 1]  664 	ld	a, (x)
      008B21 A4 3F            [ 1]  665 	and	a, #0x3f
      008B23 F7               [ 1]  666 	ld	(x), a
      008B24 88               [ 1]  667 	push	a
      008B25 CD 8C 79         [ 4]  668 	call	_BCD2BIN
      008B28 5B 01            [ 2]  669 	addw	sp, #1
      008B2A 1E 0D            [ 2]  670 	ldw	x, (0x0d, sp)
      008B2C F7               [ 1]  671 	ld	(x), a
                                    672 ;	user/ds1307.c: 182: time->month = BCD2BIN(data[5]&=0x1F);
      008B2D 1E 0F            [ 2]  673 	ldw	x, (0x0f, sp)
      008B2F 1C 00 05         [ 2]  674 	addw	x, #0x0005
      008B32 1F 11            [ 2]  675 	ldw	(0x11, sp), x
      008B34 1E 15            [ 2]  676 	ldw	x, (0x15, sp)
      008B36 1C 00 05         [ 2]  677 	addw	x, #0x0005
      008B39 F6               [ 1]  678 	ld	a, (x)
      008B3A A4 1F            [ 1]  679 	and	a, #0x1f
      008B3C F7               [ 1]  680 	ld	(x), a
      008B3D 88               [ 1]  681 	push	a
      008B3E CD 8C 79         [ 4]  682 	call	_BCD2BIN
      008B41 5B 01            [ 2]  683 	addw	sp, #1
      008B43 1E 11            [ 2]  684 	ldw	x, (0x11, sp)
      008B45 F7               [ 1]  685 	ld	(x), a
                                    686 ;	user/ds1307.c: 183: time->year = BCD2BIN(data[6]&=0xFF);
      008B46 1E 0F            [ 2]  687 	ldw	x, (0x0f, sp)
      008B48 1C 00 06         [ 2]  688 	addw	x, #0x0006
      008B4B 1F 0B            [ 2]  689 	ldw	(0x0b, sp), x
      008B4D 1E 15            [ 2]  690 	ldw	x, (0x15, sp)
      008B4F 1C 00 06         [ 2]  691 	addw	x, #0x0006
      008B52 F6               [ 1]  692 	ld	a, (x)
      008B53 F7               [ 1]  693 	ld	(x), a
      008B54 88               [ 1]  694 	push	a
      008B55 CD 8C 79         [ 4]  695 	call	_BCD2BIN
      008B58 5B 01            [ 2]  696 	addw	sp, #1
      008B5A 1E 0B            [ 2]  697 	ldw	x, (0x0b, sp)
      008B5C F7               [ 1]  698 	ld	(x), a
      008B5D 5B 18            [ 2]  699 	addw	sp, #24
      008B5F 81               [ 4]  700 	ret
                                    701 ;	user/ds1307.c: 187: unsigned char DS1307_GetSeconds(void)
                                    702 ;	-----------------------------------------
                                    703 ;	 function DS1307_GetSeconds
                                    704 ;	-----------------------------------------
      008B60                        705 _DS1307_GetSeconds:
                                    706 ;	user/ds1307.c: 190: sec=read_ds1307(0x00);
      008B60 4B 00            [ 1]  707 	push	#0x00
      008B62 CD 8B DB         [ 4]  708 	call	_read_ds1307
      008B65 5B 01            [ 2]  709 	addw	sp, #1
                                    710 ;	user/ds1307.c: 191: sec=BCD2BIN(sec&=0x7F);
      008B67 A4 7F            [ 1]  711 	and	a, #0x7f
      008B69 88               [ 1]  712 	push	a
      008B6A CD 8C 79         [ 4]  713 	call	_BCD2BIN
      008B6D 5B 01            [ 2]  714 	addw	sp, #1
                                    715 ;	user/ds1307.c: 192: return sec;
      008B6F 81               [ 4]  716 	ret
                                    717 ;	user/ds1307.c: 194: unsigned char DS1307_GetMinutes(void)
                                    718 ;	-----------------------------------------
                                    719 ;	 function DS1307_GetMinutes
                                    720 ;	-----------------------------------------
      008B70                        721 _DS1307_GetMinutes:
                                    722 ;	user/ds1307.c: 197: min=read_ds1307(0x01);
      008B70 4B 01            [ 1]  723 	push	#0x01
      008B72 CD 8B DB         [ 4]  724 	call	_read_ds1307
      008B75 5B 01            [ 2]  725 	addw	sp, #1
                                    726 ;	user/ds1307.c: 198: min=BCD2BIN(min&=0x7F);
      008B77 A4 7F            [ 1]  727 	and	a, #0x7f
      008B79 88               [ 1]  728 	push	a
      008B7A CD 8C 79         [ 4]  729 	call	_BCD2BIN
      008B7D 5B 01            [ 2]  730 	addw	sp, #1
                                    731 ;	user/ds1307.c: 199: return min;
      008B7F 81               [ 4]  732 	ret
                                    733 ;	user/ds1307.c: 201: unsigned char DS1307_GetHours(void)
                                    734 ;	-----------------------------------------
                                    735 ;	 function DS1307_GetHours
                                    736 ;	-----------------------------------------
      008B80                        737 _DS1307_GetHours:
                                    738 ;	user/ds1307.c: 204: hour=read_ds1307(0x02);
      008B80 4B 02            [ 1]  739 	push	#0x02
      008B82 CD 8B DB         [ 4]  740 	call	_read_ds1307
      008B85 5B 01            [ 2]  741 	addw	sp, #1
                                    742 ;	user/ds1307.c: 205: if((hour&0x40)!=0)    hour=BCD2BIN(hour&=0x1F);
      008B87 A5 40            [ 1]  743 	bcp	a, #0x40
      008B89 27 09            [ 1]  744 	jreq	00102$
      008B8B A4 1F            [ 1]  745 	and	a, #0x1f
      008B8D 88               [ 1]  746 	push	a
      008B8E CD 8C 79         [ 4]  747 	call	_BCD2BIN
      008B91 5B 01            [ 2]  748 	addw	sp, #1
      008B93 81               [ 4]  749 	ret
      008B94                        750 00102$:
                                    751 ;	user/ds1307.c: 206: else hour=BCD2BIN(hour&=0x3F);
      008B94 A4 3F            [ 1]  752 	and	a, #0x3f
      008B96 88               [ 1]  753 	push	a
      008B97 CD 8C 79         [ 4]  754 	call	_BCD2BIN
      008B9A 5B 01            [ 2]  755 	addw	sp, #1
                                    756 ;	user/ds1307.c: 207: return hour;
      008B9C 81               [ 4]  757 	ret
                                    758 ;	user/ds1307.c: 209: unsigned char DS1307_GetDay(void)
                                    759 ;	-----------------------------------------
                                    760 ;	 function DS1307_GetDay
                                    761 ;	-----------------------------------------
      008B9D                        762 _DS1307_GetDay:
                                    763 ;	user/ds1307.c: 212: day=read_ds1307(0x03);
      008B9D 4B 03            [ 1]  764 	push	#0x03
      008B9F CD 8B DB         [ 4]  765 	call	_read_ds1307
      008BA2 5B 01            [ 2]  766 	addw	sp, #1
                                    767 ;	user/ds1307.c: 213: day=BCD2BIN(day&=0x07);
      008BA4 A4 07            [ 1]  768 	and	a, #0x07
      008BA6 88               [ 1]  769 	push	a
      008BA7 CD 8C 79         [ 4]  770 	call	_BCD2BIN
      008BAA 5B 01            [ 2]  771 	addw	sp, #1
                                    772 ;	user/ds1307.c: 214: return day;
      008BAC 81               [ 4]  773 	ret
                                    774 ;	user/ds1307.c: 216: unsigned char DS1307_GetDate(void)
                                    775 ;	-----------------------------------------
                                    776 ;	 function DS1307_GetDate
                                    777 ;	-----------------------------------------
      008BAD                        778 _DS1307_GetDate:
                                    779 ;	user/ds1307.c: 219: date=read_ds1307(0x04);
      008BAD 4B 04            [ 1]  780 	push	#0x04
      008BAF CD 8B DB         [ 4]  781 	call	_read_ds1307
      008BB2 5B 01            [ 2]  782 	addw	sp, #1
                                    783 ;	user/ds1307.c: 220: date=BCD2BIN(date&=0x3F);
      008BB4 A4 3F            [ 1]  784 	and	a, #0x3f
      008BB6 88               [ 1]  785 	push	a
      008BB7 CD 8C 79         [ 4]  786 	call	_BCD2BIN
      008BBA 5B 01            [ 2]  787 	addw	sp, #1
                                    788 ;	user/ds1307.c: 221: return date;
      008BBC 81               [ 4]  789 	ret
                                    790 ;	user/ds1307.c: 223: unsigned char DS1307_GetMonth(void)
                                    791 ;	-----------------------------------------
                                    792 ;	 function DS1307_GetMonth
                                    793 ;	-----------------------------------------
      008BBD                        794 _DS1307_GetMonth:
                                    795 ;	user/ds1307.c: 226: month=read_ds1307(0x05);
      008BBD 4B 05            [ 1]  796 	push	#0x05
      008BBF CD 8B DB         [ 4]  797 	call	_read_ds1307
      008BC2 5B 01            [ 2]  798 	addw	sp, #1
                                    799 ;	user/ds1307.c: 227: month=BCD2BIN(month&=0x1F);
      008BC4 A4 1F            [ 1]  800 	and	a, #0x1f
      008BC6 88               [ 1]  801 	push	a
      008BC7 CD 8C 79         [ 4]  802 	call	_BCD2BIN
      008BCA 5B 01            [ 2]  803 	addw	sp, #1
                                    804 ;	user/ds1307.c: 228: return month;
      008BCC 81               [ 4]  805 	ret
                                    806 ;	user/ds1307.c: 230: unsigned char DS1307_GetYear(void)
                                    807 ;	-----------------------------------------
                                    808 ;	 function DS1307_GetYear
                                    809 ;	-----------------------------------------
      008BCD                        810 _DS1307_GetYear:
                                    811 ;	user/ds1307.c: 233: year=read_ds1307(0x06);
      008BCD 4B 06            [ 1]  812 	push	#0x06
      008BCF CD 8B DB         [ 4]  813 	call	_read_ds1307
      008BD2 5B 01            [ 2]  814 	addw	sp, #1
                                    815 ;	user/ds1307.c: 234: year=BCD2BIN(year&=0xFF);
      008BD4 88               [ 1]  816 	push	a
      008BD5 CD 8C 79         [ 4]  817 	call	_BCD2BIN
      008BD8 5B 01            [ 2]  818 	addw	sp, #1
                                    819 ;	user/ds1307.c: 235: return year;
      008BDA 81               [ 4]  820 	ret
                                    821 ;	user/ds1307.c: 238: unsigned char read_ds1307(unsigned char regadd)
                                    822 ;	-----------------------------------------
                                    823 ;	 function read_ds1307
                                    824 ;	-----------------------------------------
      008BDB                        825 _read_ds1307:
      008BDB 88               [ 1]  826 	push	a
                                    827 ;	user/ds1307.c: 242: while(I2C_GetFlagStatus( I2C_FLAG_BUSBUSY)==SET);
      008BDC                        828 00101$:
      008BDC 4B 02            [ 1]  829 	push	#0x02
      008BDE 4B 03            [ 1]  830 	push	#0x03
      008BE0 CD 98 84         [ 4]  831 	call	_I2C_GetFlagStatus
      008BE3 85               [ 2]  832 	popw	x
      008BE4 A1 01            [ 1]  833 	cp	a, #0x01
      008BE6 27 F4            [ 1]  834 	jreq	00101$
                                    835 ;	user/ds1307.c: 244: I2C_GenerateSTART(ENABLE);
      008BE8 4B 01            [ 1]  836 	push	#0x01
      008BEA CD 97 4F         [ 4]  837 	call	_I2C_GenerateSTART
      008BED 84               [ 1]  838 	pop	a
                                    839 ;	user/ds1307.c: 247: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      008BEE                        840 00104$:
      008BEE 4B 01            [ 1]  841 	push	#0x01
      008BF0 4B 03            [ 1]  842 	push	#0x03
      008BF2 CD 98 09         [ 4]  843 	call	_I2C_CheckEvent
      008BF5 85               [ 2]  844 	popw	x
      008BF6 4D               [ 1]  845 	tnz	a
      008BF7 27 F5            [ 1]  846 	jreq	00104$
                                    847 ;	user/ds1307.c: 250: I2C_Send7bitAddress(0xD0,I2C_DIRECTION_TX);
      008BF9 4B 00            [ 1]  848 	push	#0x00
      008BFB 4B D0            [ 1]  849 	push	#0xd0
      008BFD CD 97 F3         [ 4]  850 	call	_I2C_Send7bitAddress
      008C00 85               [ 2]  851 	popw	x
                                    852 ;	user/ds1307.c: 251: while(!I2C_CheckEvent( I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));
      008C01                        853 00107$:
      008C01 4B 82            [ 1]  854 	push	#0x82
      008C03 4B 07            [ 1]  855 	push	#0x07
      008C05 CD 98 09         [ 4]  856 	call	_I2C_CheckEvent
      008C08 85               [ 2]  857 	popw	x
      008C09 4D               [ 1]  858 	tnz	a
      008C0A 27 F5            [ 1]  859 	jreq	00107$
                                    860 ;	user/ds1307.c: 254: I2C_SendData(regadd);
      008C0C 7B 04            [ 1]  861 	ld	a, (0x04, sp)
      008C0E 88               [ 1]  862 	push	a
      008C0F CD 98 02         [ 4]  863 	call	_I2C_SendData
      008C12 84               [ 1]  864 	pop	a
                                    865 ;	user/ds1307.c: 255: while(I2C_GetFlagStatus(I2C_FLAG_TRANSFERFINISHED) == RESET);
      008C13                        866 00110$:
      008C13 4B 04            [ 1]  867 	push	#0x04
      008C15 4B 01            [ 1]  868 	push	#0x01
      008C17 CD 98 84         [ 4]  869 	call	_I2C_GetFlagStatus
      008C1A 85               [ 2]  870 	popw	x
      008C1B 4D               [ 1]  871 	tnz	a
      008C1C 27 F5            [ 1]  872 	jreq	00110$
                                    873 ;	user/ds1307.c: 258: I2C_GenerateSTART( ENABLE);
      008C1E 4B 01            [ 1]  874 	push	#0x01
      008C20 CD 97 4F         [ 4]  875 	call	_I2C_GenerateSTART
      008C23 84               [ 1]  876 	pop	a
                                    877 ;	user/ds1307.c: 259: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      008C24                        878 00113$:
      008C24 4B 01            [ 1]  879 	push	#0x01
      008C26 4B 03            [ 1]  880 	push	#0x03
      008C28 CD 98 09         [ 4]  881 	call	_I2C_CheckEvent
      008C2B 85               [ 2]  882 	popw	x
      008C2C 4D               [ 1]  883 	tnz	a
      008C2D 27 F5            [ 1]  884 	jreq	00113$
                                    885 ;	user/ds1307.c: 262: I2C_Send7bitAddress(0xD0,I2C_DIRECTION_RX);
      008C2F 4B 01            [ 1]  886 	push	#0x01
      008C31 4B D0            [ 1]  887 	push	#0xd0
      008C33 CD 97 F3         [ 4]  888 	call	_I2C_Send7bitAddress
      008C36 85               [ 2]  889 	popw	x
                                    890 ;	user/ds1307.c: 265: while(I2C_GetFlagStatus( I2C_FLAG_ADDRESSSENTMATCHED) == RESET);
      008C37                        891 00116$:
      008C37 4B 02            [ 1]  892 	push	#0x02
      008C39 4B 01            [ 1]  893 	push	#0x01
      008C3B CD 98 84         [ 4]  894 	call	_I2C_GetFlagStatus
      008C3E 85               [ 2]  895 	popw	x
      008C3F 4D               [ 1]  896 	tnz	a
      008C40 27 F5            [ 1]  897 	jreq	00116$
                                    898 ;	user/ds1307.c: 268: I2C_AcknowledgeConfig(I2C_ACK_NONE);
      008C42 4B 00            [ 1]  899 	push	#0x00
      008C44 CD 97 8D         [ 4]  900 	call	_I2C_AcknowledgeConfig
      008C47 84               [ 1]  901 	pop	a
                                    902 ;	user/ds1307.c: 271: I2C->SR1;        I2C->SR3;
      008C48 AE 52 17         [ 2]  903 	ldw	x, #0x5217
      008C4B F6               [ 1]  904 	ld	a, (x)
      008C4C AE 52 19         [ 2]  905 	ldw	x, #0x5219
      008C4F F6               [ 1]  906 	ld	a, (x)
                                    907 ;	user/ds1307.c: 273: I2C_GenerateSTOP(ENABLE);
      008C50 4B 01            [ 1]  908 	push	#0x01
      008C52 CD 97 5D         [ 4]  909 	call	_I2C_GenerateSTOP
      008C55 84               [ 1]  910 	pop	a
                                    911 ;	user/ds1307.c: 276: while (I2C_GetFlagStatus( I2C_FLAG_RXNOTEMPTY) == RESET);
      008C56                        912 00119$:
      008C56 4B 40            [ 1]  913 	push	#0x40
      008C58 4B 01            [ 1]  914 	push	#0x01
      008C5A CD 98 84         [ 4]  915 	call	_I2C_GetFlagStatus
      008C5D 85               [ 2]  916 	popw	x
      008C5E 4D               [ 1]  917 	tnz	a
      008C5F 27 F5            [ 1]  918 	jreq	00119$
                                    919 ;	user/ds1307.c: 279: data=I2C_ReceiveData();
      008C61 CD 97 EE         [ 4]  920 	call	_I2C_ReceiveData
      008C64 6B 01            [ 1]  921 	ld	(0x01, sp), a
                                    922 ;	user/ds1307.c: 282: while(I2C->CR2 & I2C_CR2_STOP);
      008C66                        923 00122$:
      008C66 AE 52 11         [ 2]  924 	ldw	x, #0x5211
      008C69 F6               [ 1]  925 	ld	a, (x)
      008C6A A5 02            [ 1]  926 	bcp	a, #0x02
      008C6C 26 F8            [ 1]  927 	jrne	00122$
                                    928 ;	user/ds1307.c: 284: I2C_AcknowledgeConfig( I2C_ACK_CURR);
      008C6E 4B 01            [ 1]  929 	push	#0x01
      008C70 CD 97 8D         [ 4]  930 	call	_I2C_AcknowledgeConfig
      008C73 84               [ 1]  931 	pop	a
                                    932 ;	user/ds1307.c: 285: return (data);
      008C74 7B 01            [ 1]  933 	ld	a, (0x01, sp)
      008C76 5B 01            [ 2]  934 	addw	sp, #1
      008C78 81               [ 4]  935 	ret
                                    936 ;	user/ds1307.c: 287: unsigned char BCD2BIN(unsigned char data)
                                    937 ;	-----------------------------------------
                                    938 ;	 function BCD2BIN
                                    939 ;	-----------------------------------------
      008C79                        940 _BCD2BIN:
      008C79 88               [ 1]  941 	push	a
                                    942 ;	user/ds1307.c: 290: high=(data>>4)&0x0F;
      008C7A 7B 04            [ 1]  943 	ld	a, (0x04, sp)
      008C7C 4E               [ 1]  944 	swap	a
      008C7D A4 0F            [ 1]  945 	and	a, #0x0f
      008C7F A4 0F            [ 1]  946 	and	a, #0x0f
      008C81 97               [ 1]  947 	ld	xl, a
                                    948 ;	user/ds1307.c: 291: low=data&0x0F;
      008C82 7B 04            [ 1]  949 	ld	a, (0x04, sp)
      008C84 A4 0F            [ 1]  950 	and	a, #0x0f
      008C86 6B 01            [ 1]  951 	ld	(0x01, sp), a
                                    952 ;	user/ds1307.c: 292: return ((high*10)+low);
      008C88 A6 0A            [ 1]  953 	ld	a, #0x0a
      008C8A 42               [ 4]  954 	mul	x, a
      008C8B 9F               [ 1]  955 	ld	a, xl
      008C8C 1B 01            [ 1]  956 	add	a, (0x01, sp)
      008C8E 5B 01            [ 2]  957 	addw	sp, #1
      008C90 81               [ 4]  958 	ret
                                    959 ;	user/ds1307.c: 294: unsigned char BIN2BCD(unsigned char data)
                                    960 ;	-----------------------------------------
                                    961 ;	 function BIN2BCD
                                    962 ;	-----------------------------------------
      008C91                        963 _BIN2BCD:
      008C91 88               [ 1]  964 	push	a
                                    965 ;	user/ds1307.c: 297: high=data/10;    high =(high<<4)&0xF0;
      008C92 5F               [ 1]  966 	clrw	x
      008C93 7B 04            [ 1]  967 	ld	a, (0x04, sp)
      008C95 97               [ 1]  968 	ld	xl, a
      008C96 A6 0A            [ 1]  969 	ld	a, #0x0a
      008C98 62               [ 2]  970 	div	x, a
      008C99 9F               [ 1]  971 	ld	a, xl
      008C9A 4E               [ 1]  972 	swap	a
      008C9B A4 F0            [ 1]  973 	and	a, #0xf0
      008C9D A4 F0            [ 1]  974 	and	a, #0xf0
      008C9F 6B 01            [ 1]  975 	ld	(0x01, sp), a
                                    976 ;	user/ds1307.c: 298: low=data%10;    low&=0x0F;
      008CA1 5F               [ 1]  977 	clrw	x
      008CA2 7B 04            [ 1]  978 	ld	a, (0x04, sp)
      008CA4 97               [ 1]  979 	ld	xl, a
      008CA5 A6 0A            [ 1]  980 	ld	a, #0x0a
      008CA7 62               [ 2]  981 	div	x, a
      008CA8 A4 0F            [ 1]  982 	and	a, #0x0f
                                    983 ;	user/ds1307.c: 299: return ((high)|low);
      008CAA 1A 01            [ 1]  984 	or	a, (0x01, sp)
      008CAC 5B 01            [ 2]  985 	addw	sp, #1
      008CAE 81               [ 4]  986 	ret
                                    987 	.area CODE
                                    988 	.area INITIALIZER
                                    989 	.area CABS (ABS)
