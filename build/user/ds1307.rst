                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ANSI-C Compiler
                                      3 ; Version 3.6.0 #9615 (MINGW64)
                                      4 ;--------------------------------------------------------
                                      5 	.module ds1307
                                      6 	.optsdcc -mstm8
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _I2C_GetFlagStatus
                                     12 	.globl _I2C_CheckEvent
                                     13 	.globl _I2C_SendData
                                     14 	.globl _I2C_Send7bitAddress
                                     15 	.globl _I2C_ReceiveData
                                     16 	.globl _I2C_AcknowledgeConfig
                                     17 	.globl _I2C_GenerateSTOP
                                     18 	.globl _I2C_GenerateSTART
                                     19 	.globl _I2C_Cmd
                                     20 	.globl _I2C_Init
                                     21 	.globl _I2C_DeInit
                                     22 	.globl _CLK_GetClockFreq
                                     23 	.globl _CLK_PeripheralClockConfig
                                     24 	.globl _DS1307_Init
                                     25 	.globl _DS1307_write_time
                                     26 	.globl _DS1307_SetTime
                                     27 	.globl _DS1307_GetDateTime
                                     28 	.globl _DS1307_GetSeconds
                                     29 	.globl _DS1307_GetMinutes
                                     30 	.globl _DS1307_GetHours
                                     31 	.globl _DS1307_GetDay
                                     32 	.globl _DS1307_GetDate
                                     33 	.globl _DS1307_GetMonth
                                     34 	.globl _DS1307_GetYear
                                     35 	.globl _read_ds1307
                                     36 	.globl _BCD2BIN
                                     37 	.globl _BIN2BCD
                                     38 ;--------------------------------------------------------
                                     39 ; ram data
                                     40 ;--------------------------------------------------------
                                     41 	.area DATA
                                     42 ;--------------------------------------------------------
                                     43 ; ram data
                                     44 ;--------------------------------------------------------
                                     45 	.area INITIALIZED
                                     46 ;--------------------------------------------------------
                                     47 ; absolute external ram data
                                     48 ;--------------------------------------------------------
                                     49 	.area DABS (ABS)
                                     50 ;--------------------------------------------------------
                                     51 ; global & static initialisations
                                     52 ;--------------------------------------------------------
                                     53 	.area HOME
                                     54 	.area GSINIT
                                     55 	.area GSFINAL
                                     56 	.area GSINIT
                                     57 ;--------------------------------------------------------
                                     58 ; Home
                                     59 ;--------------------------------------------------------
                                     60 	.area HOME
                                     61 	.area HOME
                                     62 ;--------------------------------------------------------
                                     63 ; code
                                     64 ;--------------------------------------------------------
                                     65 	.area CODE
                                     66 ;	user/ds1307.c: 6: void DS1307_Init(void)
                                     67 ;	-----------------------------------------
                                     68 ;	 function DS1307_Init
                                     69 ;	-----------------------------------------
      00866F                         70 _DS1307_Init:
      00866F 88               [ 1]   71 	push	a
                                     72 ;	user/ds1307.c: 9: Input_Clock = CLK_GetClockFreq()/1000000;
      008670 CD 90 87         [ 4]   73 	call	_CLK_GetClockFreq
      008673 4B 40            [ 1]   74 	push	#0x40
      008675 4B 42            [ 1]   75 	push	#0x42
      008677 4B 0F            [ 1]   76 	push	#0x0f
      008679 4B 00            [ 1]   77 	push	#0x00
      00867B 89               [ 2]   78 	pushw	x
      00867C 90 89            [ 2]   79 	pushw	y
      00867E CD 96 FB         [ 4]   80 	call	__divulong
      008681 5B 08            [ 2]   81 	addw	sp, #8
      008683 9F               [ 1]   82 	ld	a, xl
      008684 6B 01            [ 1]   83 	ld	(0x01, sp), a
                                     84 ;	user/ds1307.c: 10: I2C_DeInit();
      008686 CD 91 BF         [ 4]   85 	call	_I2C_DeInit
                                     86 ;	user/ds1307.c: 11: CLK_PeripheralClockConfig(CLK_PERIPHERAL_I2C, ENABLE);
      008689 4B 01            [ 1]   87 	push	#0x01
      00868B 4B 00            [ 1]   88 	push	#0x00
      00868D CD 8F FA         [ 4]   89 	call	_CLK_PeripheralClockConfig
      008690 85               [ 2]   90 	popw	x
                                     91 ;	user/ds1307.c: 12: I2C_Cmd( ENABLE);
      008691 4B 01            [ 1]   92 	push	#0x01
      008693 CD 93 12         [ 4]   93 	call	_I2C_Cmd
      008696 84               [ 1]   94 	pop	a
                                     95 ;	user/ds1307.c: 14: I2C_Init(DS1307_I2C_CLOCK, DS1307_I2C_ADDR, I2C_DUTYCYCLE_2, I2C_ACK_CURR, I2C_ADDMODE_7BIT,Input_Clock);
      008697 7B 01            [ 1]   96 	ld	a, (0x01, sp)
      008699 88               [ 1]   97 	push	a
      00869A 4B 00            [ 1]   98 	push	#0x00
      00869C 4B 01            [ 1]   99 	push	#0x01
      00869E 4B 00            [ 1]  100 	push	#0x00
      0086A0 4B D0            [ 1]  101 	push	#0xd0
      0086A2 4B 00            [ 1]  102 	push	#0x00
      0086A4 4B 10            [ 1]  103 	push	#0x10
      0086A6 4B 27            [ 1]  104 	push	#0x27
      0086A8 5F               [ 1]  105 	clrw	x
      0086A9 89               [ 2]  106 	pushw	x
      0086AA CD 91 E4         [ 4]  107 	call	_I2C_Init
      0086AD 5B 0B            [ 2]  108 	addw	sp, #11
      0086AF 81               [ 4]  109 	ret
                                    110 ;	user/ds1307.c: 17: void DS1307_write_time(unsigned char hour1,unsigned char min1,unsigned char day1,unsigned char date1,unsigned char month1,unsigned char year1)
                                    111 ;	-----------------------------------------
                                    112 ;	 function DS1307_write_time
                                    113 ;	-----------------------------------------
      0086B0                        114 _DS1307_write_time:
      0086B0 52 15            [ 2]  115 	sub	sp, #21
                                    116 ;	user/ds1307.c: 20: data[0]=BIN2BCD(0x0);
      0086B2 96               [ 1]  117 	ldw	x, sp
      0086B3 5C               [ 2]  118 	incw	x
      0086B4 1F 14            [ 2]  119 	ldw	(0x14, sp), x
      0086B6 4B 00            [ 1]  120 	push	#0x00
      0086B8 CD 8B 51         [ 4]  121 	call	_BIN2BCD
      0086BB 5B 01            [ 2]  122 	addw	sp, #1
      0086BD 1E 14            [ 2]  123 	ldw	x, (0x14, sp)
      0086BF F7               [ 1]  124 	ld	(x), a
                                    125 ;	user/ds1307.c: 21: data[1]=BIN2BCD(min1);
      0086C0 1E 14            [ 2]  126 	ldw	x, (0x14, sp)
      0086C2 5C               [ 2]  127 	incw	x
      0086C3 1F 0A            [ 2]  128 	ldw	(0x0a, sp), x
      0086C5 7B 19            [ 1]  129 	ld	a, (0x19, sp)
      0086C7 88               [ 1]  130 	push	a
      0086C8 CD 8B 51         [ 4]  131 	call	_BIN2BCD
      0086CB 5B 01            [ 2]  132 	addw	sp, #1
      0086CD 1E 0A            [ 2]  133 	ldw	x, (0x0a, sp)
      0086CF F7               [ 1]  134 	ld	(x), a
                                    135 ;	user/ds1307.c: 22: data[2]=BIN2BCD(hour1);
      0086D0 1E 14            [ 2]  136 	ldw	x, (0x14, sp)
      0086D2 5C               [ 2]  137 	incw	x
      0086D3 5C               [ 2]  138 	incw	x
      0086D4 1F 12            [ 2]  139 	ldw	(0x12, sp), x
      0086D6 7B 18            [ 1]  140 	ld	a, (0x18, sp)
      0086D8 88               [ 1]  141 	push	a
      0086D9 CD 8B 51         [ 4]  142 	call	_BIN2BCD
      0086DC 5B 01            [ 2]  143 	addw	sp, #1
      0086DE 1E 12            [ 2]  144 	ldw	x, (0x12, sp)
      0086E0 F7               [ 1]  145 	ld	(x), a
                                    146 ;	user/ds1307.c: 23: data[3]=BIN2BCD(day1);
      0086E1 1E 14            [ 2]  147 	ldw	x, (0x14, sp)
      0086E3 1C 00 03         [ 2]  148 	addw	x, #0x0003
      0086E6 1F 0E            [ 2]  149 	ldw	(0x0e, sp), x
      0086E8 7B 1A            [ 1]  150 	ld	a, (0x1a, sp)
      0086EA 88               [ 1]  151 	push	a
      0086EB CD 8B 51         [ 4]  152 	call	_BIN2BCD
      0086EE 5B 01            [ 2]  153 	addw	sp, #1
      0086F0 1E 0E            [ 2]  154 	ldw	x, (0x0e, sp)
      0086F2 F7               [ 1]  155 	ld	(x), a
                                    156 ;	user/ds1307.c: 24: data[4]=BIN2BCD(date1);
      0086F3 1E 14            [ 2]  157 	ldw	x, (0x14, sp)
      0086F5 1C 00 04         [ 2]  158 	addw	x, #0x0004
      0086F8 1F 08            [ 2]  159 	ldw	(0x08, sp), x
      0086FA 7B 1B            [ 1]  160 	ld	a, (0x1b, sp)
      0086FC 88               [ 1]  161 	push	a
      0086FD CD 8B 51         [ 4]  162 	call	_BIN2BCD
      008700 5B 01            [ 2]  163 	addw	sp, #1
      008702 1E 08            [ 2]  164 	ldw	x, (0x08, sp)
      008704 F7               [ 1]  165 	ld	(x), a
                                    166 ;	user/ds1307.c: 25: data[5]=BIN2BCD(month1);
      008705 1E 14            [ 2]  167 	ldw	x, (0x14, sp)
      008707 1C 00 05         [ 2]  168 	addw	x, #0x0005
      00870A 1F 0C            [ 2]  169 	ldw	(0x0c, sp), x
      00870C 7B 1C            [ 1]  170 	ld	a, (0x1c, sp)
      00870E 88               [ 1]  171 	push	a
      00870F CD 8B 51         [ 4]  172 	call	_BIN2BCD
      008712 5B 01            [ 2]  173 	addw	sp, #1
      008714 1E 0C            [ 2]  174 	ldw	x, (0x0c, sp)
      008716 F7               [ 1]  175 	ld	(x), a
                                    176 ;	user/ds1307.c: 26: data[6]=BIN2BCD(year1);
      008717 1E 14            [ 2]  177 	ldw	x, (0x14, sp)
      008719 1C 00 06         [ 2]  178 	addw	x, #0x0006
      00871C 1F 10            [ 2]  179 	ldw	(0x10, sp), x
      00871E 7B 1D            [ 1]  180 	ld	a, (0x1d, sp)
      008720 88               [ 1]  181 	push	a
      008721 CD 8B 51         [ 4]  182 	call	_BIN2BCD
      008724 5B 01            [ 2]  183 	addw	sp, #1
      008726 1E 10            [ 2]  184 	ldw	x, (0x10, sp)
      008728 F7               [ 1]  185 	ld	(x), a
                                    186 ;	user/ds1307.c: 28: while(I2C_GetFlagStatus( I2C_FLAG_BUSBUSY)==SET);
      008729                        187 00101$:
      008729 4B 02            [ 1]  188 	push	#0x02
      00872B 4B 03            [ 1]  189 	push	#0x03
      00872D CD 94 69         [ 4]  190 	call	_I2C_GetFlagStatus
      008730 85               [ 2]  191 	popw	x
      008731 A1 01            [ 1]  192 	cp	a, #0x01
      008733 27 F4            [ 1]  193 	jreq	00101$
                                    194 ;	user/ds1307.c: 29: I2C_GenerateSTART(ENABLE);
      008735 4B 01            [ 1]  195 	push	#0x01
      008737 CD 93 34         [ 4]  196 	call	_I2C_GenerateSTART
      00873A 84               [ 1]  197 	pop	a
                                    198 ;	user/ds1307.c: 32: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      00873B                        199 00104$:
      00873B 4B 01            [ 1]  200 	push	#0x01
      00873D 4B 03            [ 1]  201 	push	#0x03
      00873F CD 93 EE         [ 4]  202 	call	_I2C_CheckEvent
      008742 85               [ 2]  203 	popw	x
      008743 4D               [ 1]  204 	tnz	a
      008744 27 F5            [ 1]  205 	jreq	00104$
                                    206 ;	user/ds1307.c: 35: I2C_Send7bitAddress(DS1307_ADDR_WRITE,I2C_DIRECTION_TX);
      008746 4B 00            [ 1]  207 	push	#0x00
      008748 4B D0            [ 1]  208 	push	#0xd0
      00874A CD 93 D8         [ 4]  209 	call	_I2C_Send7bitAddress
      00874D 85               [ 2]  210 	popw	x
                                    211 ;	user/ds1307.c: 38: while(!I2C_CheckEvent( I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));
      00874E                        212 00107$:
      00874E 4B 82            [ 1]  213 	push	#0x82
      008750 4B 07            [ 1]  214 	push	#0x07
      008752 CD 93 EE         [ 4]  215 	call	_I2C_CheckEvent
      008755 85               [ 2]  216 	popw	x
      008756 4D               [ 1]  217 	tnz	a
      008757 27 F5            [ 1]  218 	jreq	00107$
                                    219 ;	user/ds1307.c: 42: I2C_SendData( 0x01);
      008759 4B 01            [ 1]  220 	push	#0x01
      00875B CD 93 E7         [ 4]  221 	call	_I2C_SendData
      00875E 84               [ 1]  222 	pop	a
                                    223 ;	user/ds1307.c: 45: while(!I2C_CheckEvent( I2C_EVENT_MASTER_BYTE_TRANSMITTED));
      00875F                        224 00110$:
      00875F 4B 84            [ 1]  225 	push	#0x84
      008761 4B 07            [ 1]  226 	push	#0x07
      008763 CD 93 EE         [ 4]  227 	call	_I2C_CheckEvent
      008766 85               [ 2]  228 	popw	x
      008767 4D               [ 1]  229 	tnz	a
      008768 27 F5            [ 1]  230 	jreq	00110$
                                    231 ;	user/ds1307.c: 49: I2C_SendData( data[1]);
      00876A 1E 0A            [ 2]  232 	ldw	x, (0x0a, sp)
      00876C F6               [ 1]  233 	ld	a, (x)
      00876D 88               [ 1]  234 	push	a
      00876E CD 93 E7         [ 4]  235 	call	_I2C_SendData
      008771 84               [ 1]  236 	pop	a
                                    237 ;	user/ds1307.c: 52: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008772                        238 00113$:
      008772 4B 04            [ 1]  239 	push	#0x04
      008774 4B 01            [ 1]  240 	push	#0x01
      008776 CD 94 69         [ 4]  241 	call	_I2C_GetFlagStatus
      008779 85               [ 2]  242 	popw	x
      00877A 4D               [ 1]  243 	tnz	a
      00877B 27 F5            [ 1]  244 	jreq	00113$
                                    245 ;	user/ds1307.c: 55: I2C_SendData( data[2]);
      00877D 1E 12            [ 2]  246 	ldw	x, (0x12, sp)
      00877F F6               [ 1]  247 	ld	a, (x)
      008780 88               [ 1]  248 	push	a
      008781 CD 93 E7         [ 4]  249 	call	_I2C_SendData
      008784 84               [ 1]  250 	pop	a
                                    251 ;	user/ds1307.c: 58: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008785                        252 00116$:
      008785 4B 04            [ 1]  253 	push	#0x04
      008787 4B 01            [ 1]  254 	push	#0x01
      008789 CD 94 69         [ 4]  255 	call	_I2C_GetFlagStatus
      00878C 85               [ 2]  256 	popw	x
      00878D 4D               [ 1]  257 	tnz	a
      00878E 27 F5            [ 1]  258 	jreq	00116$
                                    259 ;	user/ds1307.c: 61: I2C_SendData( data[3]);
      008790 1E 0E            [ 2]  260 	ldw	x, (0x0e, sp)
      008792 F6               [ 1]  261 	ld	a, (x)
      008793 88               [ 1]  262 	push	a
      008794 CD 93 E7         [ 4]  263 	call	_I2C_SendData
      008797 84               [ 1]  264 	pop	a
                                    265 ;	user/ds1307.c: 64: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008798                        266 00119$:
      008798 4B 04            [ 1]  267 	push	#0x04
      00879A 4B 01            [ 1]  268 	push	#0x01
      00879C CD 94 69         [ 4]  269 	call	_I2C_GetFlagStatus
      00879F 85               [ 2]  270 	popw	x
      0087A0 4D               [ 1]  271 	tnz	a
      0087A1 27 F5            [ 1]  272 	jreq	00119$
                                    273 ;	user/ds1307.c: 67: I2C_SendData( data[4]);
      0087A3 1E 08            [ 2]  274 	ldw	x, (0x08, sp)
      0087A5 F6               [ 1]  275 	ld	a, (x)
      0087A6 88               [ 1]  276 	push	a
      0087A7 CD 93 E7         [ 4]  277 	call	_I2C_SendData
      0087AA 84               [ 1]  278 	pop	a
                                    279 ;	user/ds1307.c: 70: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0087AB                        280 00122$:
      0087AB 4B 04            [ 1]  281 	push	#0x04
      0087AD 4B 01            [ 1]  282 	push	#0x01
      0087AF CD 94 69         [ 4]  283 	call	_I2C_GetFlagStatus
      0087B2 85               [ 2]  284 	popw	x
      0087B3 4D               [ 1]  285 	tnz	a
      0087B4 27 F5            [ 1]  286 	jreq	00122$
                                    287 ;	user/ds1307.c: 73: I2C_SendData( data[5]);
      0087B6 1E 0C            [ 2]  288 	ldw	x, (0x0c, sp)
      0087B8 F6               [ 1]  289 	ld	a, (x)
      0087B9 88               [ 1]  290 	push	a
      0087BA CD 93 E7         [ 4]  291 	call	_I2C_SendData
      0087BD 84               [ 1]  292 	pop	a
                                    293 ;	user/ds1307.c: 76: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0087BE                        294 00125$:
      0087BE 4B 04            [ 1]  295 	push	#0x04
      0087C0 4B 01            [ 1]  296 	push	#0x01
      0087C2 CD 94 69         [ 4]  297 	call	_I2C_GetFlagStatus
      0087C5 85               [ 2]  298 	popw	x
      0087C6 4D               [ 1]  299 	tnz	a
      0087C7 27 F5            [ 1]  300 	jreq	00125$
                                    301 ;	user/ds1307.c: 79: I2C_SendData( data[6]);
      0087C9 1E 10            [ 2]  302 	ldw	x, (0x10, sp)
      0087CB F6               [ 1]  303 	ld	a, (x)
      0087CC 88               [ 1]  304 	push	a
      0087CD CD 93 E7         [ 4]  305 	call	_I2C_SendData
      0087D0 84               [ 1]  306 	pop	a
                                    307 ;	user/ds1307.c: 82: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0087D1                        308 00128$:
      0087D1 4B 04            [ 1]  309 	push	#0x04
      0087D3 4B 01            [ 1]  310 	push	#0x01
      0087D5 CD 94 69         [ 4]  311 	call	_I2C_GetFlagStatus
      0087D8 85               [ 2]  312 	popw	x
      0087D9 4D               [ 1]  313 	tnz	a
      0087DA 27 F5            [ 1]  314 	jreq	00128$
                                    315 ;	user/ds1307.c: 85: I2C_GenerateSTOP(ENABLE);
      0087DC 4B 01            [ 1]  316 	push	#0x01
      0087DE CD 93 42         [ 4]  317 	call	_I2C_GenerateSTOP
      0087E1 84               [ 1]  318 	pop	a
                                    319 ;	user/ds1307.c: 88: I2C->SR1;		I2C->SR3;
      0087E2 AE 52 17         [ 2]  320 	ldw	x, #0x5217
      0087E5 F6               [ 1]  321 	ld	a, (x)
      0087E6 AE 52 19         [ 2]  322 	ldw	x, #0x5219
      0087E9 F6               [ 1]  323 	ld	a, (x)
      0087EA 5B 15            [ 2]  324 	addw	sp, #21
      0087EC 81               [ 4]  325 	ret
                                    326 ;	user/ds1307.c: 92: void DS1307_SetTime(DS1307_Time_t* time)
                                    327 ;	-----------------------------------------
                                    328 ;	 function DS1307_SetTime
                                    329 ;	-----------------------------------------
      0087ED                        330 _DS1307_SetTime:
      0087ED 52 17            [ 2]  331 	sub	sp, #23
                                    332 ;	user/ds1307.c: 95: data[0]=BIN2BCD(time->seconds);
      0087EF 96               [ 1]  333 	ldw	x, sp
      0087F0 5C               [ 2]  334 	incw	x
      0087F1 1F 14            [ 2]  335 	ldw	(0x14, sp), x
      0087F3 16 1A            [ 2]  336 	ldw	y, (0x1a, sp)
      0087F5 17 16            [ 2]  337 	ldw	(0x16, sp), y
      0087F7 1E 16            [ 2]  338 	ldw	x, (0x16, sp)
      0087F9 F6               [ 1]  339 	ld	a, (x)
      0087FA 88               [ 1]  340 	push	a
      0087FB CD 8B 51         [ 4]  341 	call	_BIN2BCD
      0087FE 5B 01            [ 2]  342 	addw	sp, #1
      008800 1E 14            [ 2]  343 	ldw	x, (0x14, sp)
      008802 F7               [ 1]  344 	ld	(x), a
                                    345 ;	user/ds1307.c: 96: data[1]=BIN2BCD(time->minutes);
      008803 1E 14            [ 2]  346 	ldw	x, (0x14, sp)
      008805 5C               [ 2]  347 	incw	x
      008806 1F 10            [ 2]  348 	ldw	(0x10, sp), x
      008808 1E 16            [ 2]  349 	ldw	x, (0x16, sp)
      00880A E6 01            [ 1]  350 	ld	a, (0x1, x)
      00880C 88               [ 1]  351 	push	a
      00880D CD 8B 51         [ 4]  352 	call	_BIN2BCD
      008810 5B 01            [ 2]  353 	addw	sp, #1
      008812 1E 10            [ 2]  354 	ldw	x, (0x10, sp)
      008814 F7               [ 1]  355 	ld	(x), a
                                    356 ;	user/ds1307.c: 97: data[2]=BIN2BCD(time->hours);
      008815 1E 14            [ 2]  357 	ldw	x, (0x14, sp)
      008817 5C               [ 2]  358 	incw	x
      008818 5C               [ 2]  359 	incw	x
      008819 1F 08            [ 2]  360 	ldw	(0x08, sp), x
      00881B 1E 16            [ 2]  361 	ldw	x, (0x16, sp)
      00881D E6 02            [ 1]  362 	ld	a, (0x2, x)
      00881F 88               [ 1]  363 	push	a
      008820 CD 8B 51         [ 4]  364 	call	_BIN2BCD
      008823 5B 01            [ 2]  365 	addw	sp, #1
      008825 1E 08            [ 2]  366 	ldw	x, (0x08, sp)
      008827 F7               [ 1]  367 	ld	(x), a
                                    368 ;	user/ds1307.c: 98: data[3]=BIN2BCD(time->day);
      008828 1E 14            [ 2]  369 	ldw	x, (0x14, sp)
      00882A 1C 00 03         [ 2]  370 	addw	x, #0x0003
      00882D 1F 0E            [ 2]  371 	ldw	(0x0e, sp), x
      00882F 1E 16            [ 2]  372 	ldw	x, (0x16, sp)
      008831 E6 03            [ 1]  373 	ld	a, (0x3, x)
      008833 88               [ 1]  374 	push	a
      008834 CD 8B 51         [ 4]  375 	call	_BIN2BCD
      008837 5B 01            [ 2]  376 	addw	sp, #1
      008839 1E 0E            [ 2]  377 	ldw	x, (0x0e, sp)
      00883B F7               [ 1]  378 	ld	(x), a
                                    379 ;	user/ds1307.c: 99: data[4]=BIN2BCD(time->date);
      00883C 1E 14            [ 2]  380 	ldw	x, (0x14, sp)
      00883E 1C 00 04         [ 2]  381 	addw	x, #0x0004
      008841 1F 0C            [ 2]  382 	ldw	(0x0c, sp), x
      008843 1E 16            [ 2]  383 	ldw	x, (0x16, sp)
      008845 E6 04            [ 1]  384 	ld	a, (0x4, x)
      008847 88               [ 1]  385 	push	a
      008848 CD 8B 51         [ 4]  386 	call	_BIN2BCD
      00884B 5B 01            [ 2]  387 	addw	sp, #1
      00884D 1E 0C            [ 2]  388 	ldw	x, (0x0c, sp)
      00884F F7               [ 1]  389 	ld	(x), a
                                    390 ;	user/ds1307.c: 100: data[5]=BIN2BCD(time->month);
      008850 1E 14            [ 2]  391 	ldw	x, (0x14, sp)
      008852 1C 00 05         [ 2]  392 	addw	x, #0x0005
      008855 1F 0A            [ 2]  393 	ldw	(0x0a, sp), x
      008857 1E 16            [ 2]  394 	ldw	x, (0x16, sp)
      008859 E6 05            [ 1]  395 	ld	a, (0x5, x)
      00885B 88               [ 1]  396 	push	a
      00885C CD 8B 51         [ 4]  397 	call	_BIN2BCD
      00885F 5B 01            [ 2]  398 	addw	sp, #1
      008861 1E 0A            [ 2]  399 	ldw	x, (0x0a, sp)
      008863 F7               [ 1]  400 	ld	(x), a
                                    401 ;	user/ds1307.c: 101: data[6]=BIN2BCD(time->year);
      008864 1E 14            [ 2]  402 	ldw	x, (0x14, sp)
      008866 1C 00 06         [ 2]  403 	addw	x, #0x0006
      008869 1F 12            [ 2]  404 	ldw	(0x12, sp), x
      00886B 1E 16            [ 2]  405 	ldw	x, (0x16, sp)
      00886D E6 06            [ 1]  406 	ld	a, (0x6, x)
      00886F 88               [ 1]  407 	push	a
      008870 CD 8B 51         [ 4]  408 	call	_BIN2BCD
      008873 5B 01            [ 2]  409 	addw	sp, #1
      008875 1E 12            [ 2]  410 	ldw	x, (0x12, sp)
      008877 F7               [ 1]  411 	ld	(x), a
                                    412 ;	user/ds1307.c: 103: while(I2C_GetFlagStatus( I2C_FLAG_BUSBUSY)==SET);
      008878                        413 00101$:
      008878 4B 02            [ 1]  414 	push	#0x02
      00887A 4B 03            [ 1]  415 	push	#0x03
      00887C CD 94 69         [ 4]  416 	call	_I2C_GetFlagStatus
      00887F 85               [ 2]  417 	popw	x
      008880 A1 01            [ 1]  418 	cp	a, #0x01
      008882 27 F4            [ 1]  419 	jreq	00101$
                                    420 ;	user/ds1307.c: 104: I2C_GenerateSTART(ENABLE);
      008884 4B 01            [ 1]  421 	push	#0x01
      008886 CD 93 34         [ 4]  422 	call	_I2C_GenerateSTART
      008889 84               [ 1]  423 	pop	a
                                    424 ;	user/ds1307.c: 107: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      00888A                        425 00104$:
      00888A 4B 01            [ 1]  426 	push	#0x01
      00888C 4B 03            [ 1]  427 	push	#0x03
      00888E CD 93 EE         [ 4]  428 	call	_I2C_CheckEvent
      008891 85               [ 2]  429 	popw	x
      008892 4D               [ 1]  430 	tnz	a
      008893 27 F5            [ 1]  431 	jreq	00104$
                                    432 ;	user/ds1307.c: 110: I2C_Send7bitAddress((uint8_t)DS1307_ADDR_WRITE,I2C_DIRECTION_TX);
      008895 4B 00            [ 1]  433 	push	#0x00
      008897 4B D0            [ 1]  434 	push	#0xd0
      008899 CD 93 D8         [ 4]  435 	call	_I2C_Send7bitAddress
      00889C 85               [ 2]  436 	popw	x
                                    437 ;	user/ds1307.c: 113: while(!I2C_CheckEvent( I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));
      00889D                        438 00107$:
      00889D 4B 82            [ 1]  439 	push	#0x82
      00889F 4B 07            [ 1]  440 	push	#0x07
      0088A1 CD 93 EE         [ 4]  441 	call	_I2C_CheckEvent
      0088A4 85               [ 2]  442 	popw	x
      0088A5 4D               [ 1]  443 	tnz	a
      0088A6 27 F5            [ 1]  444 	jreq	00107$
                                    445 ;	user/ds1307.c: 116: I2C_SendData( 0x01);
      0088A8 4B 01            [ 1]  446 	push	#0x01
      0088AA CD 93 E7         [ 4]  447 	call	_I2C_SendData
      0088AD 84               [ 1]  448 	pop	a
                                    449 ;	user/ds1307.c: 119: while(!I2C_CheckEvent( I2C_EVENT_MASTER_BYTE_TRANSMITTED));
      0088AE                        450 00110$:
      0088AE 4B 84            [ 1]  451 	push	#0x84
      0088B0 4B 07            [ 1]  452 	push	#0x07
      0088B2 CD 93 EE         [ 4]  453 	call	_I2C_CheckEvent
      0088B5 85               [ 2]  454 	popw	x
      0088B6 4D               [ 1]  455 	tnz	a
      0088B7 27 F5            [ 1]  456 	jreq	00110$
                                    457 ;	user/ds1307.c: 123: I2C_SendData( data[1]);
      0088B9 1E 10            [ 2]  458 	ldw	x, (0x10, sp)
      0088BB F6               [ 1]  459 	ld	a, (x)
      0088BC 88               [ 1]  460 	push	a
      0088BD CD 93 E7         [ 4]  461 	call	_I2C_SendData
      0088C0 84               [ 1]  462 	pop	a
                                    463 ;	user/ds1307.c: 126: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0088C1                        464 00113$:
      0088C1 4B 04            [ 1]  465 	push	#0x04
      0088C3 4B 01            [ 1]  466 	push	#0x01
      0088C5 CD 94 69         [ 4]  467 	call	_I2C_GetFlagStatus
      0088C8 85               [ 2]  468 	popw	x
      0088C9 4D               [ 1]  469 	tnz	a
      0088CA 27 F5            [ 1]  470 	jreq	00113$
                                    471 ;	user/ds1307.c: 129: I2C_SendData( data[2]);
      0088CC 1E 08            [ 2]  472 	ldw	x, (0x08, sp)
      0088CE F6               [ 1]  473 	ld	a, (x)
      0088CF 88               [ 1]  474 	push	a
      0088D0 CD 93 E7         [ 4]  475 	call	_I2C_SendData
      0088D3 84               [ 1]  476 	pop	a
                                    477 ;	user/ds1307.c: 132: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0088D4                        478 00116$:
      0088D4 4B 04            [ 1]  479 	push	#0x04
      0088D6 4B 01            [ 1]  480 	push	#0x01
      0088D8 CD 94 69         [ 4]  481 	call	_I2C_GetFlagStatus
      0088DB 85               [ 2]  482 	popw	x
      0088DC 4D               [ 1]  483 	tnz	a
      0088DD 27 F5            [ 1]  484 	jreq	00116$
                                    485 ;	user/ds1307.c: 135: I2C_SendData( data[3]);
      0088DF 1E 0E            [ 2]  486 	ldw	x, (0x0e, sp)
      0088E1 F6               [ 1]  487 	ld	a, (x)
      0088E2 88               [ 1]  488 	push	a
      0088E3 CD 93 E7         [ 4]  489 	call	_I2C_SendData
      0088E6 84               [ 1]  490 	pop	a
                                    491 ;	user/ds1307.c: 138: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0088E7                        492 00119$:
      0088E7 4B 04            [ 1]  493 	push	#0x04
      0088E9 4B 01            [ 1]  494 	push	#0x01
      0088EB CD 94 69         [ 4]  495 	call	_I2C_GetFlagStatus
      0088EE 85               [ 2]  496 	popw	x
      0088EF 4D               [ 1]  497 	tnz	a
      0088F0 27 F5            [ 1]  498 	jreq	00119$
                                    499 ;	user/ds1307.c: 141: I2C_SendData( data[4]);
      0088F2 1E 0C            [ 2]  500 	ldw	x, (0x0c, sp)
      0088F4 F6               [ 1]  501 	ld	a, (x)
      0088F5 88               [ 1]  502 	push	a
      0088F6 CD 93 E7         [ 4]  503 	call	_I2C_SendData
      0088F9 84               [ 1]  504 	pop	a
                                    505 ;	user/ds1307.c: 144: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0088FA                        506 00122$:
      0088FA 4B 04            [ 1]  507 	push	#0x04
      0088FC 4B 01            [ 1]  508 	push	#0x01
      0088FE CD 94 69         [ 4]  509 	call	_I2C_GetFlagStatus
      008901 85               [ 2]  510 	popw	x
      008902 4D               [ 1]  511 	tnz	a
      008903 27 F5            [ 1]  512 	jreq	00122$
                                    513 ;	user/ds1307.c: 147: I2C_SendData( data[5]);
      008905 1E 0A            [ 2]  514 	ldw	x, (0x0a, sp)
      008907 F6               [ 1]  515 	ld	a, (x)
      008908 88               [ 1]  516 	push	a
      008909 CD 93 E7         [ 4]  517 	call	_I2C_SendData
      00890C 84               [ 1]  518 	pop	a
                                    519 ;	user/ds1307.c: 150: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      00890D                        520 00125$:
      00890D 4B 04            [ 1]  521 	push	#0x04
      00890F 4B 01            [ 1]  522 	push	#0x01
      008911 CD 94 69         [ 4]  523 	call	_I2C_GetFlagStatus
      008914 85               [ 2]  524 	popw	x
      008915 4D               [ 1]  525 	tnz	a
      008916 27 F5            [ 1]  526 	jreq	00125$
                                    527 ;	user/ds1307.c: 153: I2C_SendData( data[6]);
      008918 1E 12            [ 2]  528 	ldw	x, (0x12, sp)
      00891A F6               [ 1]  529 	ld	a, (x)
      00891B 88               [ 1]  530 	push	a
      00891C CD 93 E7         [ 4]  531 	call	_I2C_SendData
      00891F 84               [ 1]  532 	pop	a
                                    533 ;	user/ds1307.c: 156: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      008920                        534 00128$:
      008920 4B 04            [ 1]  535 	push	#0x04
      008922 4B 01            [ 1]  536 	push	#0x01
      008924 CD 94 69         [ 4]  537 	call	_I2C_GetFlagStatus
      008927 85               [ 2]  538 	popw	x
      008928 4D               [ 1]  539 	tnz	a
      008929 27 F5            [ 1]  540 	jreq	00128$
                                    541 ;	user/ds1307.c: 159: I2C_GenerateSTOP(ENABLE);
      00892B 4B 01            [ 1]  542 	push	#0x01
      00892D CD 93 42         [ 4]  543 	call	_I2C_GenerateSTOP
      008930 84               [ 1]  544 	pop	a
                                    545 ;	user/ds1307.c: 162: I2C->SR1;        I2C->SR3;
      008931 AE 52 17         [ 2]  546 	ldw	x, #0x5217
      008934 F6               [ 1]  547 	ld	a, (x)
      008935 AE 52 19         [ 2]  548 	ldw	x, #0x5219
      008938 F6               [ 1]  549 	ld	a, (x)
      008939 5B 17            [ 2]  550 	addw	sp, #23
      00893B 81               [ 4]  551 	ret
                                    552 ;	user/ds1307.c: 165: void DS1307_GetDateTime(DS1307_Time_t* time) {
                                    553 ;	-----------------------------------------
                                    554 ;	 function DS1307_GetDateTime
                                    555 ;	-----------------------------------------
      00893C                        556 _DS1307_GetDateTime:
      00893C 52 18            [ 2]  557 	sub	sp, #24
                                    558 ;	user/ds1307.c: 168: for(i=0;i<8;i++)
      00893E 96               [ 1]  559 	ldw	x, sp
      00893F 5C               [ 2]  560 	incw	x
      008940 1F 13            [ 2]  561 	ldw	(0x13, sp), x
      008942 0F 08            [ 1]  562 	clr	(0x08, sp)
      008944                        563 00105$:
                                    564 ;	user/ds1307.c: 170: data[i]=read_ds1307(i);
      008944 5F               [ 1]  565 	clrw	x
      008945 7B 08            [ 1]  566 	ld	a, (0x08, sp)
      008947 97               [ 1]  567 	ld	xl, a
      008948 72 FB 13         [ 2]  568 	addw	x, (0x13, sp)
      00894B 89               [ 2]  569 	pushw	x
      00894C 7B 0A            [ 1]  570 	ld	a, (0x0a, sp)
      00894E 88               [ 1]  571 	push	a
      00894F CD 8A 9B         [ 4]  572 	call	_read_ds1307
      008952 5B 01            [ 2]  573 	addw	sp, #1
      008954 85               [ 2]  574 	popw	x
      008955 F7               [ 1]  575 	ld	(x), a
                                    576 ;	user/ds1307.c: 168: for(i=0;i<8;i++)
      008956 0C 08            [ 1]  577 	inc	(0x08, sp)
      008958 7B 08            [ 1]  578 	ld	a, (0x08, sp)
      00895A A1 08            [ 1]  579 	cp	a, #0x08
      00895C 25 E6            [ 1]  580 	jrc	00105$
                                    581 ;	user/ds1307.c: 173: time->seconds = BCD2BIN(data[0]&=0x7F);
      00895E 16 1B            [ 2]  582 	ldw	y, (0x1b, sp)
      008960 17 11            [ 2]  583 	ldw	(0x11, sp), y
      008962 1E 13            [ 2]  584 	ldw	x, (0x13, sp)
      008964 F6               [ 1]  585 	ld	a, (x)
      008965 A4 7F            [ 1]  586 	and	a, #0x7f
      008967 1E 13            [ 2]  587 	ldw	x, (0x13, sp)
      008969 F7               [ 1]  588 	ld	(x), a
      00896A 88               [ 1]  589 	push	a
      00896B CD 8B 39         [ 4]  590 	call	_BCD2BIN
      00896E 5B 01            [ 2]  591 	addw	sp, #1
      008970 1E 11            [ 2]  592 	ldw	x, (0x11, sp)
      008972 F7               [ 1]  593 	ld	(x), a
                                    594 ;	user/ds1307.c: 175: time->minutes = BCD2BIN(data[1]&=0x7F);
      008973 1E 11            [ 2]  595 	ldw	x, (0x11, sp)
      008975 5C               [ 2]  596 	incw	x
      008976 1F 15            [ 2]  597 	ldw	(0x15, sp), x
      008978 1E 13            [ 2]  598 	ldw	x, (0x13, sp)
      00897A 5C               [ 2]  599 	incw	x
      00897B F6               [ 1]  600 	ld	a, (x)
      00897C A4 7F            [ 1]  601 	and	a, #0x7f
      00897E F7               [ 1]  602 	ld	(x), a
      00897F 89               [ 2]  603 	pushw	x
      008980 88               [ 1]  604 	push	a
      008981 CD 8B 39         [ 4]  605 	call	_BCD2BIN
      008984 5B 01            [ 2]  606 	addw	sp, #1
      008986 85               [ 2]  607 	popw	x
      008987 16 15            [ 2]  608 	ldw	y, (0x15, sp)
      008989 90 F7            [ 1]  609 	ld	(y), a
                                    610 ;	user/ds1307.c: 177: if((data[1]&0x40)!=0)    time->hours=BCD2BIN(data[2]&=0x1F);
      00898B F6               [ 1]  611 	ld	a, (x)
      00898C 90 97            [ 1]  612 	ld	yl, a
      00898E 1E 11            [ 2]  613 	ldw	x, (0x11, sp)
      008990 5C               [ 2]  614 	incw	x
      008991 5C               [ 2]  615 	incw	x
      008992 1F 0B            [ 2]  616 	ldw	(0x0b, sp), x
      008994 1E 13            [ 2]  617 	ldw	x, (0x13, sp)
      008996 5C               [ 2]  618 	incw	x
      008997 5C               [ 2]  619 	incw	x
      008998 F6               [ 1]  620 	ld	a, (x)
      008999 88               [ 1]  621 	push	a
      00899A 90 9F            [ 1]  622 	ld	a, yl
      00899C A5 40            [ 1]  623 	bcp	a, #0x40
      00899E 84               [ 1]  624 	pop	a
      00899F 27 0E            [ 1]  625 	jreq	00103$
      0089A1 A4 1F            [ 1]  626 	and	a, #0x1f
      0089A3 F7               [ 1]  627 	ld	(x), a
      0089A4 88               [ 1]  628 	push	a
      0089A5 CD 8B 39         [ 4]  629 	call	_BCD2BIN
      0089A8 5B 01            [ 2]  630 	addw	sp, #1
      0089AA 1E 0B            [ 2]  631 	ldw	x, (0x0b, sp)
      0089AC F7               [ 1]  632 	ld	(x), a
      0089AD 20 0C            [ 2]  633 	jra	00104$
      0089AF                        634 00103$:
                                    635 ;	user/ds1307.c: 178: else time->hours=BCD2BIN(data[2]&=0x3F);
      0089AF A4 3F            [ 1]  636 	and	a, #0x3f
      0089B1 F7               [ 1]  637 	ld	(x), a
      0089B2 88               [ 1]  638 	push	a
      0089B3 CD 8B 39         [ 4]  639 	call	_BCD2BIN
      0089B6 5B 01            [ 2]  640 	addw	sp, #1
      0089B8 1E 0B            [ 2]  641 	ldw	x, (0x0b, sp)
      0089BA F7               [ 1]  642 	ld	(x), a
      0089BB                        643 00104$:
                                    644 ;	user/ds1307.c: 180: time->day = BCD2BIN(data[3]&=0x07);
      0089BB 1E 11            [ 2]  645 	ldw	x, (0x11, sp)
      0089BD 1C 00 03         [ 2]  646 	addw	x, #0x0003
      0089C0 1F 0D            [ 2]  647 	ldw	(0x0d, sp), x
      0089C2 1E 13            [ 2]  648 	ldw	x, (0x13, sp)
      0089C4 1C 00 03         [ 2]  649 	addw	x, #0x0003
      0089C7 F6               [ 1]  650 	ld	a, (x)
      0089C8 A4 07            [ 1]  651 	and	a, #0x07
      0089CA F7               [ 1]  652 	ld	(x), a
      0089CB 88               [ 1]  653 	push	a
      0089CC CD 8B 39         [ 4]  654 	call	_BCD2BIN
      0089CF 5B 01            [ 2]  655 	addw	sp, #1
      0089D1 1E 0D            [ 2]  656 	ldw	x, (0x0d, sp)
      0089D3 F7               [ 1]  657 	ld	(x), a
                                    658 ;	user/ds1307.c: 181: time->date = BCD2BIN(data[4]&=0x3F);
      0089D4 1E 11            [ 2]  659 	ldw	x, (0x11, sp)
      0089D6 1C 00 04         [ 2]  660 	addw	x, #0x0004
      0089D9 1F 17            [ 2]  661 	ldw	(0x17, sp), x
      0089DB 1E 13            [ 2]  662 	ldw	x, (0x13, sp)
      0089DD 1C 00 04         [ 2]  663 	addw	x, #0x0004
      0089E0 F6               [ 1]  664 	ld	a, (x)
      0089E1 A4 3F            [ 1]  665 	and	a, #0x3f
      0089E3 F7               [ 1]  666 	ld	(x), a
      0089E4 88               [ 1]  667 	push	a
      0089E5 CD 8B 39         [ 4]  668 	call	_BCD2BIN
      0089E8 5B 01            [ 2]  669 	addw	sp, #1
      0089EA 1E 17            [ 2]  670 	ldw	x, (0x17, sp)
      0089EC F7               [ 1]  671 	ld	(x), a
                                    672 ;	user/ds1307.c: 182: time->month = BCD2BIN(data[5]&=0x1F);
      0089ED 1E 11            [ 2]  673 	ldw	x, (0x11, sp)
      0089EF 1C 00 05         [ 2]  674 	addw	x, #0x0005
      0089F2 1F 0F            [ 2]  675 	ldw	(0x0f, sp), x
      0089F4 1E 13            [ 2]  676 	ldw	x, (0x13, sp)
      0089F6 1C 00 05         [ 2]  677 	addw	x, #0x0005
      0089F9 F6               [ 1]  678 	ld	a, (x)
      0089FA A4 1F            [ 1]  679 	and	a, #0x1f
      0089FC F7               [ 1]  680 	ld	(x), a
      0089FD 88               [ 1]  681 	push	a
      0089FE CD 8B 39         [ 4]  682 	call	_BCD2BIN
      008A01 5B 01            [ 2]  683 	addw	sp, #1
      008A03 1E 0F            [ 2]  684 	ldw	x, (0x0f, sp)
      008A05 F7               [ 1]  685 	ld	(x), a
                                    686 ;	user/ds1307.c: 183: time->year = BCD2BIN(data[6]&=0xFF);
      008A06 1E 11            [ 2]  687 	ldw	x, (0x11, sp)
      008A08 1C 00 06         [ 2]  688 	addw	x, #0x0006
      008A0B 1F 09            [ 2]  689 	ldw	(0x09, sp), x
      008A0D 1E 13            [ 2]  690 	ldw	x, (0x13, sp)
      008A0F 1C 00 06         [ 2]  691 	addw	x, #0x0006
      008A12 F6               [ 1]  692 	ld	a, (x)
      008A13 F7               [ 1]  693 	ld	(x), a
      008A14 88               [ 1]  694 	push	a
      008A15 CD 8B 39         [ 4]  695 	call	_BCD2BIN
      008A18 5B 01            [ 2]  696 	addw	sp, #1
      008A1A 1E 09            [ 2]  697 	ldw	x, (0x09, sp)
      008A1C F7               [ 1]  698 	ld	(x), a
      008A1D 5B 18            [ 2]  699 	addw	sp, #24
      008A1F 81               [ 4]  700 	ret
                                    701 ;	user/ds1307.c: 187: unsigned char DS1307_GetSeconds(void)
                                    702 ;	-----------------------------------------
                                    703 ;	 function DS1307_GetSeconds
                                    704 ;	-----------------------------------------
      008A20                        705 _DS1307_GetSeconds:
                                    706 ;	user/ds1307.c: 190: sec=read_ds1307(0x00);
      008A20 4B 00            [ 1]  707 	push	#0x00
      008A22 CD 8A 9B         [ 4]  708 	call	_read_ds1307
      008A25 5B 01            [ 2]  709 	addw	sp, #1
                                    710 ;	user/ds1307.c: 191: sec=BCD2BIN(sec&=0x7F);
      008A27 A4 7F            [ 1]  711 	and	a, #0x7f
      008A29 88               [ 1]  712 	push	a
      008A2A CD 8B 39         [ 4]  713 	call	_BCD2BIN
      008A2D 5B 01            [ 2]  714 	addw	sp, #1
                                    715 ;	user/ds1307.c: 192: return sec;
      008A2F 81               [ 4]  716 	ret
                                    717 ;	user/ds1307.c: 194: unsigned char DS1307_GetMinutes(void)
                                    718 ;	-----------------------------------------
                                    719 ;	 function DS1307_GetMinutes
                                    720 ;	-----------------------------------------
      008A30                        721 _DS1307_GetMinutes:
                                    722 ;	user/ds1307.c: 197: min=read_ds1307(0x01);
      008A30 4B 01            [ 1]  723 	push	#0x01
      008A32 CD 8A 9B         [ 4]  724 	call	_read_ds1307
      008A35 5B 01            [ 2]  725 	addw	sp, #1
                                    726 ;	user/ds1307.c: 198: min=BCD2BIN(min&=0x7F);
      008A37 A4 7F            [ 1]  727 	and	a, #0x7f
      008A39 88               [ 1]  728 	push	a
      008A3A CD 8B 39         [ 4]  729 	call	_BCD2BIN
      008A3D 5B 01            [ 2]  730 	addw	sp, #1
                                    731 ;	user/ds1307.c: 199: return min;
      008A3F 81               [ 4]  732 	ret
                                    733 ;	user/ds1307.c: 201: unsigned char DS1307_GetHours(void)
                                    734 ;	-----------------------------------------
                                    735 ;	 function DS1307_GetHours
                                    736 ;	-----------------------------------------
      008A40                        737 _DS1307_GetHours:
                                    738 ;	user/ds1307.c: 204: hour=read_ds1307(0x02);
      008A40 4B 02            [ 1]  739 	push	#0x02
      008A42 CD 8A 9B         [ 4]  740 	call	_read_ds1307
      008A45 5B 01            [ 2]  741 	addw	sp, #1
                                    742 ;	user/ds1307.c: 205: if((hour&0x40)!=0)    hour=BCD2BIN(hour&=0x1F);
      008A47 A5 40            [ 1]  743 	bcp	a, #0x40
      008A49 27 09            [ 1]  744 	jreq	00102$
      008A4B A4 1F            [ 1]  745 	and	a, #0x1f
      008A4D 88               [ 1]  746 	push	a
      008A4E CD 8B 39         [ 4]  747 	call	_BCD2BIN
      008A51 5B 01            [ 2]  748 	addw	sp, #1
      008A53 81               [ 4]  749 	ret
      008A54                        750 00102$:
                                    751 ;	user/ds1307.c: 206: else hour=BCD2BIN(hour&=0x3F);
      008A54 A4 3F            [ 1]  752 	and	a, #0x3f
      008A56 88               [ 1]  753 	push	a
      008A57 CD 8B 39         [ 4]  754 	call	_BCD2BIN
      008A5A 5B 01            [ 2]  755 	addw	sp, #1
                                    756 ;	user/ds1307.c: 207: return hour;
      008A5C 81               [ 4]  757 	ret
                                    758 ;	user/ds1307.c: 209: unsigned char DS1307_GetDay(void)
                                    759 ;	-----------------------------------------
                                    760 ;	 function DS1307_GetDay
                                    761 ;	-----------------------------------------
      008A5D                        762 _DS1307_GetDay:
                                    763 ;	user/ds1307.c: 212: day=read_ds1307(0x03);
      008A5D 4B 03            [ 1]  764 	push	#0x03
      008A5F CD 8A 9B         [ 4]  765 	call	_read_ds1307
      008A62 5B 01            [ 2]  766 	addw	sp, #1
                                    767 ;	user/ds1307.c: 213: day=BCD2BIN(day&=0x07);
      008A64 A4 07            [ 1]  768 	and	a, #0x07
      008A66 88               [ 1]  769 	push	a
      008A67 CD 8B 39         [ 4]  770 	call	_BCD2BIN
      008A6A 5B 01            [ 2]  771 	addw	sp, #1
                                    772 ;	user/ds1307.c: 214: return day;
      008A6C 81               [ 4]  773 	ret
                                    774 ;	user/ds1307.c: 216: unsigned char DS1307_GetDate(void)
                                    775 ;	-----------------------------------------
                                    776 ;	 function DS1307_GetDate
                                    777 ;	-----------------------------------------
      008A6D                        778 _DS1307_GetDate:
                                    779 ;	user/ds1307.c: 219: date=read_ds1307(0x04);
      008A6D 4B 04            [ 1]  780 	push	#0x04
      008A6F CD 8A 9B         [ 4]  781 	call	_read_ds1307
      008A72 5B 01            [ 2]  782 	addw	sp, #1
                                    783 ;	user/ds1307.c: 220: date=BCD2BIN(date&=0x3F);
      008A74 A4 3F            [ 1]  784 	and	a, #0x3f
      008A76 88               [ 1]  785 	push	a
      008A77 CD 8B 39         [ 4]  786 	call	_BCD2BIN
      008A7A 5B 01            [ 2]  787 	addw	sp, #1
                                    788 ;	user/ds1307.c: 221: return date;
      008A7C 81               [ 4]  789 	ret
                                    790 ;	user/ds1307.c: 223: unsigned char DS1307_GetMonth(void)
                                    791 ;	-----------------------------------------
                                    792 ;	 function DS1307_GetMonth
                                    793 ;	-----------------------------------------
      008A7D                        794 _DS1307_GetMonth:
                                    795 ;	user/ds1307.c: 226: month=read_ds1307(0x05);
      008A7D 4B 05            [ 1]  796 	push	#0x05
      008A7F CD 8A 9B         [ 4]  797 	call	_read_ds1307
      008A82 5B 01            [ 2]  798 	addw	sp, #1
                                    799 ;	user/ds1307.c: 227: month=BCD2BIN(month&=0x1F);
      008A84 A4 1F            [ 1]  800 	and	a, #0x1f
      008A86 88               [ 1]  801 	push	a
      008A87 CD 8B 39         [ 4]  802 	call	_BCD2BIN
      008A8A 5B 01            [ 2]  803 	addw	sp, #1
                                    804 ;	user/ds1307.c: 228: return month;
      008A8C 81               [ 4]  805 	ret
                                    806 ;	user/ds1307.c: 230: unsigned char DS1307_GetYear(void)
                                    807 ;	-----------------------------------------
                                    808 ;	 function DS1307_GetYear
                                    809 ;	-----------------------------------------
      008A8D                        810 _DS1307_GetYear:
                                    811 ;	user/ds1307.c: 233: year=read_ds1307(0x06);
      008A8D 4B 06            [ 1]  812 	push	#0x06
      008A8F CD 8A 9B         [ 4]  813 	call	_read_ds1307
      008A92 5B 01            [ 2]  814 	addw	sp, #1
                                    815 ;	user/ds1307.c: 234: year=BCD2BIN(year&=0xFF);
      008A94 88               [ 1]  816 	push	a
      008A95 CD 8B 39         [ 4]  817 	call	_BCD2BIN
      008A98 5B 01            [ 2]  818 	addw	sp, #1
                                    819 ;	user/ds1307.c: 235: return year;
      008A9A 81               [ 4]  820 	ret
                                    821 ;	user/ds1307.c: 238: unsigned char read_ds1307(unsigned char regadd)
                                    822 ;	-----------------------------------------
                                    823 ;	 function read_ds1307
                                    824 ;	-----------------------------------------
      008A9B                        825 _read_ds1307:
      008A9B 88               [ 1]  826 	push	a
                                    827 ;	user/ds1307.c: 242: while(I2C_GetFlagStatus( I2C_FLAG_BUSBUSY)==SET);
      008A9C                        828 00101$:
      008A9C 4B 02            [ 1]  829 	push	#0x02
      008A9E 4B 03            [ 1]  830 	push	#0x03
      008AA0 CD 94 69         [ 4]  831 	call	_I2C_GetFlagStatus
      008AA3 85               [ 2]  832 	popw	x
      008AA4 A1 01            [ 1]  833 	cp	a, #0x01
      008AA6 27 F4            [ 1]  834 	jreq	00101$
                                    835 ;	user/ds1307.c: 244: I2C_GenerateSTART(ENABLE);
      008AA8 4B 01            [ 1]  836 	push	#0x01
      008AAA CD 93 34         [ 4]  837 	call	_I2C_GenerateSTART
      008AAD 84               [ 1]  838 	pop	a
                                    839 ;	user/ds1307.c: 247: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      008AAE                        840 00104$:
      008AAE 4B 01            [ 1]  841 	push	#0x01
      008AB0 4B 03            [ 1]  842 	push	#0x03
      008AB2 CD 93 EE         [ 4]  843 	call	_I2C_CheckEvent
      008AB5 85               [ 2]  844 	popw	x
      008AB6 4D               [ 1]  845 	tnz	a
      008AB7 27 F5            [ 1]  846 	jreq	00104$
                                    847 ;	user/ds1307.c: 250: I2C_Send7bitAddress(0xD0,I2C_DIRECTION_TX);
      008AB9 4B 00            [ 1]  848 	push	#0x00
      008ABB 4B D0            [ 1]  849 	push	#0xd0
      008ABD CD 93 D8         [ 4]  850 	call	_I2C_Send7bitAddress
      008AC0 85               [ 2]  851 	popw	x
                                    852 ;	user/ds1307.c: 251: while(!I2C_CheckEvent( I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));
      008AC1                        853 00107$:
      008AC1 4B 82            [ 1]  854 	push	#0x82
      008AC3 4B 07            [ 1]  855 	push	#0x07
      008AC5 CD 93 EE         [ 4]  856 	call	_I2C_CheckEvent
      008AC8 85               [ 2]  857 	popw	x
      008AC9 4D               [ 1]  858 	tnz	a
      008ACA 27 F5            [ 1]  859 	jreq	00107$
                                    860 ;	user/ds1307.c: 254: I2C_SendData(regadd);
      008ACC 7B 04            [ 1]  861 	ld	a, (0x04, sp)
      008ACE 88               [ 1]  862 	push	a
      008ACF CD 93 E7         [ 4]  863 	call	_I2C_SendData
      008AD2 84               [ 1]  864 	pop	a
                                    865 ;	user/ds1307.c: 255: while(I2C_GetFlagStatus(I2C_FLAG_TRANSFERFINISHED) == RESET);
      008AD3                        866 00110$:
      008AD3 4B 04            [ 1]  867 	push	#0x04
      008AD5 4B 01            [ 1]  868 	push	#0x01
      008AD7 CD 94 69         [ 4]  869 	call	_I2C_GetFlagStatus
      008ADA 85               [ 2]  870 	popw	x
      008ADB 4D               [ 1]  871 	tnz	a
      008ADC 27 F5            [ 1]  872 	jreq	00110$
                                    873 ;	user/ds1307.c: 258: I2C_GenerateSTART( ENABLE);
      008ADE 4B 01            [ 1]  874 	push	#0x01
      008AE0 CD 93 34         [ 4]  875 	call	_I2C_GenerateSTART
      008AE3 84               [ 1]  876 	pop	a
                                    877 ;	user/ds1307.c: 259: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      008AE4                        878 00113$:
      008AE4 4B 01            [ 1]  879 	push	#0x01
      008AE6 4B 03            [ 1]  880 	push	#0x03
      008AE8 CD 93 EE         [ 4]  881 	call	_I2C_CheckEvent
      008AEB 85               [ 2]  882 	popw	x
      008AEC 4D               [ 1]  883 	tnz	a
      008AED 27 F5            [ 1]  884 	jreq	00113$
                                    885 ;	user/ds1307.c: 262: I2C_Send7bitAddress(0xD0,I2C_DIRECTION_RX);
      008AEF 4B 01            [ 1]  886 	push	#0x01
      008AF1 4B D0            [ 1]  887 	push	#0xd0
      008AF3 CD 93 D8         [ 4]  888 	call	_I2C_Send7bitAddress
      008AF6 85               [ 2]  889 	popw	x
                                    890 ;	user/ds1307.c: 265: while(I2C_GetFlagStatus( I2C_FLAG_ADDRESSSENTMATCHED) == RESET);
      008AF7                        891 00116$:
      008AF7 4B 02            [ 1]  892 	push	#0x02
      008AF9 4B 01            [ 1]  893 	push	#0x01
      008AFB CD 94 69         [ 4]  894 	call	_I2C_GetFlagStatus
      008AFE 85               [ 2]  895 	popw	x
      008AFF 4D               [ 1]  896 	tnz	a
      008B00 27 F5            [ 1]  897 	jreq	00116$
                                    898 ;	user/ds1307.c: 268: I2C_AcknowledgeConfig(I2C_ACK_NONE);
      008B02 4B 00            [ 1]  899 	push	#0x00
      008B04 CD 93 72         [ 4]  900 	call	_I2C_AcknowledgeConfig
      008B07 84               [ 1]  901 	pop	a
                                    902 ;	user/ds1307.c: 271: I2C->SR1;        I2C->SR3;
      008B08 AE 52 17         [ 2]  903 	ldw	x, #0x5217
      008B0B F6               [ 1]  904 	ld	a, (x)
      008B0C AE 52 19         [ 2]  905 	ldw	x, #0x5219
      008B0F F6               [ 1]  906 	ld	a, (x)
                                    907 ;	user/ds1307.c: 273: I2C_GenerateSTOP(ENABLE);
      008B10 4B 01            [ 1]  908 	push	#0x01
      008B12 CD 93 42         [ 4]  909 	call	_I2C_GenerateSTOP
      008B15 84               [ 1]  910 	pop	a
                                    911 ;	user/ds1307.c: 276: while (I2C_GetFlagStatus( I2C_FLAG_RXNOTEMPTY) == RESET);
      008B16                        912 00119$:
      008B16 4B 40            [ 1]  913 	push	#0x40
      008B18 4B 01            [ 1]  914 	push	#0x01
      008B1A CD 94 69         [ 4]  915 	call	_I2C_GetFlagStatus
      008B1D 85               [ 2]  916 	popw	x
      008B1E 4D               [ 1]  917 	tnz	a
      008B1F 27 F5            [ 1]  918 	jreq	00119$
                                    919 ;	user/ds1307.c: 279: data=I2C_ReceiveData();
      008B21 CD 93 D3         [ 4]  920 	call	_I2C_ReceiveData
      008B24 6B 01            [ 1]  921 	ld	(0x01, sp), a
                                    922 ;	user/ds1307.c: 282: while(I2C->CR2 & I2C_CR2_STOP);
      008B26                        923 00122$:
      008B26 AE 52 11         [ 2]  924 	ldw	x, #0x5211
      008B29 F6               [ 1]  925 	ld	a, (x)
      008B2A A5 02            [ 1]  926 	bcp	a, #0x02
      008B2C 26 F8            [ 1]  927 	jrne	00122$
                                    928 ;	user/ds1307.c: 284: I2C_AcknowledgeConfig( I2C_ACK_CURR);
      008B2E 4B 01            [ 1]  929 	push	#0x01
      008B30 CD 93 72         [ 4]  930 	call	_I2C_AcknowledgeConfig
      008B33 84               [ 1]  931 	pop	a
                                    932 ;	user/ds1307.c: 285: return (data);
      008B34 7B 01            [ 1]  933 	ld	a, (0x01, sp)
      008B36 5B 01            [ 2]  934 	addw	sp, #1
      008B38 81               [ 4]  935 	ret
                                    936 ;	user/ds1307.c: 287: unsigned char BCD2BIN(unsigned char data)
                                    937 ;	-----------------------------------------
                                    938 ;	 function BCD2BIN
                                    939 ;	-----------------------------------------
      008B39                        940 _BCD2BIN:
      008B39 88               [ 1]  941 	push	a
                                    942 ;	user/ds1307.c: 290: high=(data>>4)&0x0F;
      008B3A 7B 04            [ 1]  943 	ld	a, (0x04, sp)
      008B3C 4E               [ 1]  944 	swap	a
      008B3D A4 0F            [ 1]  945 	and	a, #0x0f
      008B3F A4 0F            [ 1]  946 	and	a, #0x0f
      008B41 97               [ 1]  947 	ld	xl, a
                                    948 ;	user/ds1307.c: 291: low=data&0x0F;
      008B42 7B 04            [ 1]  949 	ld	a, (0x04, sp)
      008B44 A4 0F            [ 1]  950 	and	a, #0x0f
      008B46 6B 01            [ 1]  951 	ld	(0x01, sp), a
                                    952 ;	user/ds1307.c: 292: return ((high*10)+low);
      008B48 A6 0A            [ 1]  953 	ld	a, #0x0a
      008B4A 42               [ 4]  954 	mul	x, a
      008B4B 9F               [ 1]  955 	ld	a, xl
      008B4C 1B 01            [ 1]  956 	add	a, (0x01, sp)
      008B4E 5B 01            [ 2]  957 	addw	sp, #1
      008B50 81               [ 4]  958 	ret
                                    959 ;	user/ds1307.c: 294: unsigned char BIN2BCD(unsigned char data)
                                    960 ;	-----------------------------------------
                                    961 ;	 function BIN2BCD
                                    962 ;	-----------------------------------------
      008B51                        963 _BIN2BCD:
      008B51 88               [ 1]  964 	push	a
                                    965 ;	user/ds1307.c: 297: high=data/10;    high =(high<<4)&0xF0;
      008B52 5F               [ 1]  966 	clrw	x
      008B53 7B 04            [ 1]  967 	ld	a, (0x04, sp)
      008B55 97               [ 1]  968 	ld	xl, a
      008B56 A6 0A            [ 1]  969 	ld	a, #0x0a
      008B58 62               [ 2]  970 	div	x, a
      008B59 9F               [ 1]  971 	ld	a, xl
      008B5A 4E               [ 1]  972 	swap	a
      008B5B A4 F0            [ 1]  973 	and	a, #0xf0
      008B5D A4 F0            [ 1]  974 	and	a, #0xf0
      008B5F 6B 01            [ 1]  975 	ld	(0x01, sp), a
                                    976 ;	user/ds1307.c: 298: low=data%10;    low&=0x0F;
      008B61 5F               [ 1]  977 	clrw	x
      008B62 7B 04            [ 1]  978 	ld	a, (0x04, sp)
      008B64 97               [ 1]  979 	ld	xl, a
      008B65 A6 0A            [ 1]  980 	ld	a, #0x0a
      008B67 62               [ 2]  981 	div	x, a
      008B68 A4 0F            [ 1]  982 	and	a, #0x0f
                                    983 ;	user/ds1307.c: 299: return ((high)|low);
      008B6A 1A 01            [ 1]  984 	or	a, (0x01, sp)
      008B6C 5B 01            [ 2]  985 	addw	sp, #1
      008B6E 81               [ 4]  986 	ret
                                    987 	.area CODE
                                    988 	.area INITIALIZER
                                    989 	.area CABS (ABS)
