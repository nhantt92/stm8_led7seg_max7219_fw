                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ANSI-C Compiler
                                      3 ; Version 3.6.0 #9615 (MINGW64)
                                      4 ;--------------------------------------------------------
                                      5 	.module ds1307
                                      6 	.optsdcc -mstm8
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _I2C_GetFlagStatus
                                     12 	.globl _I2C_CheckEvent
                                     13 	.globl _I2C_SendData
                                     14 	.globl _I2C_Send7bitAddress
                                     15 	.globl _I2C_ReceiveData
                                     16 	.globl _I2C_AcknowledgeConfig
                                     17 	.globl _I2C_GenerateSTOP
                                     18 	.globl _I2C_GenerateSTART
                                     19 	.globl _I2C_Cmd
                                     20 	.globl _I2C_Init
                                     21 	.globl _I2C_DeInit
                                     22 	.globl _CLK_GetClockFreq
                                     23 	.globl _CLK_PeripheralClockConfig
                                     24 	.globl _DS1307_Init
                                     25 	.globl _DS1307_write_time
                                     26 	.globl _DS1307_SetTime
                                     27 	.globl _DS1307_GetDateTime
                                     28 	.globl _DS1307_GetSeconds
                                     29 	.globl _DS1307_GetMinutes
                                     30 	.globl _DS1307_GetHours
                                     31 	.globl _DS1307_GetDay
                                     32 	.globl _DS1307_GetDate
                                     33 	.globl _DS1307_GetMonth
                                     34 	.globl _DS1307_GetYear
                                     35 	.globl _read_ds1307
                                     36 	.globl _BCD2BIN
                                     37 	.globl _BIN2BCD
                                     38 ;--------------------------------------------------------
                                     39 ; ram data
                                     40 ;--------------------------------------------------------
                                     41 	.area DATA
                                     42 ;--------------------------------------------------------
                                     43 ; ram data
                                     44 ;--------------------------------------------------------
                                     45 	.area INITIALIZED
                                     46 ;--------------------------------------------------------
                                     47 ; absolute external ram data
                                     48 ;--------------------------------------------------------
                                     49 	.area DABS (ABS)
                                     50 ;--------------------------------------------------------
                                     51 ; global & static initialisations
                                     52 ;--------------------------------------------------------
                                     53 	.area HOME
                                     54 	.area GSINIT
                                     55 	.area GSFINAL
                                     56 	.area GSINIT
                                     57 ;--------------------------------------------------------
                                     58 ; Home
                                     59 ;--------------------------------------------------------
                                     60 	.area HOME
                                     61 	.area HOME
                                     62 ;--------------------------------------------------------
                                     63 ; code
                                     64 ;--------------------------------------------------------
                                     65 	.area CODE
                                     66 ;	user/ds1307.c: 6: void DS1307_Init(void)
                                     67 ;	-----------------------------------------
                                     68 ;	 function DS1307_Init
                                     69 ;	-----------------------------------------
      000000                         70 _DS1307_Init:
      000000 88               [ 1]   71 	push	a
                                     72 ;	user/ds1307.c: 9: Input_Clock = CLK_GetClockFreq()/1000000;
      000001 CDr00r00         [ 4]   73 	call	_CLK_GetClockFreq
      000004 4B 40            [ 1]   74 	push	#0x40
      000006 4B 42            [ 1]   75 	push	#0x42
      000008 4B 0F            [ 1]   76 	push	#0x0f
      00000A 4B 00            [ 1]   77 	push	#0x00
      00000C 89               [ 2]   78 	pushw	x
      00000D 90 89            [ 2]   79 	pushw	y
      00000F CDr00r00         [ 4]   80 	call	__divulong
      000012 5B 08            [ 2]   81 	addw	sp, #8
      000014 9F               [ 1]   82 	ld	a, xl
      000015 6B 01            [ 1]   83 	ld	(0x01, sp), a
                                     84 ;	user/ds1307.c: 10: I2C_DeInit();
      000017 CDr00r00         [ 4]   85 	call	_I2C_DeInit
                                     86 ;	user/ds1307.c: 11: CLK_PeripheralClockConfig(CLK_PERIPHERAL_I2C, ENABLE);
      00001A 4B 01            [ 1]   87 	push	#0x01
      00001C 4B 00            [ 1]   88 	push	#0x00
      00001E CDr00r00         [ 4]   89 	call	_CLK_PeripheralClockConfig
      000021 85               [ 2]   90 	popw	x
                                     91 ;	user/ds1307.c: 12: I2C_Cmd( ENABLE);
      000022 4B 01            [ 1]   92 	push	#0x01
      000024 CDr00r00         [ 4]   93 	call	_I2C_Cmd
      000027 84               [ 1]   94 	pop	a
                                     95 ;	user/ds1307.c: 14: I2C_Init(DS1307_I2C_CLOCK, DS1307_I2C_ADDR, I2C_DUTYCYCLE_2, I2C_ACK_CURR, I2C_ADDMODE_7BIT,Input_Clock);
      000028 7B 01            [ 1]   96 	ld	a, (0x01, sp)
      00002A 88               [ 1]   97 	push	a
      00002B 4B 00            [ 1]   98 	push	#0x00
      00002D 4B 01            [ 1]   99 	push	#0x01
      00002F 4B 00            [ 1]  100 	push	#0x00
      000031 4B D0            [ 1]  101 	push	#0xd0
      000033 4B 00            [ 1]  102 	push	#0x00
      000035 4B 10            [ 1]  103 	push	#0x10
      000037 4B 27            [ 1]  104 	push	#0x27
      000039 5F               [ 1]  105 	clrw	x
      00003A 89               [ 2]  106 	pushw	x
      00003B CDr00r00         [ 4]  107 	call	_I2C_Init
      00003E 5B 0B            [ 2]  108 	addw	sp, #11
      000040 81               [ 4]  109 	ret
                                    110 ;	user/ds1307.c: 17: void DS1307_write_time(unsigned char hour1,unsigned char min1,unsigned char day1,unsigned char date1,unsigned char month1,unsigned char year1)
                                    111 ;	-----------------------------------------
                                    112 ;	 function DS1307_write_time
                                    113 ;	-----------------------------------------
      000041                        114 _DS1307_write_time:
      000041 52 15            [ 2]  115 	sub	sp, #21
                                    116 ;	user/ds1307.c: 20: data[0]=BIN2BCD(0x0);
      000043 96               [ 1]  117 	ldw	x, sp
      000044 5C               [ 2]  118 	incw	x
      000045 1F 0A            [ 2]  119 	ldw	(0x0a, sp), x
      000047 4B 00            [ 1]  120 	push	#0x00
      000049 CDr04rE2         [ 4]  121 	call	_BIN2BCD
      00004C 5B 01            [ 2]  122 	addw	sp, #1
      00004E 1E 0A            [ 2]  123 	ldw	x, (0x0a, sp)
      000050 F7               [ 1]  124 	ld	(x), a
                                    125 ;	user/ds1307.c: 21: data[1]=BIN2BCD(min1);
      000051 1E 0A            [ 2]  126 	ldw	x, (0x0a, sp)
      000053 5C               [ 2]  127 	incw	x
      000054 1F 10            [ 2]  128 	ldw	(0x10, sp), x
      000056 7B 19            [ 1]  129 	ld	a, (0x19, sp)
      000058 88               [ 1]  130 	push	a
      000059 CDr04rE2         [ 4]  131 	call	_BIN2BCD
      00005C 5B 01            [ 2]  132 	addw	sp, #1
      00005E 1E 10            [ 2]  133 	ldw	x, (0x10, sp)
      000060 F7               [ 1]  134 	ld	(x), a
                                    135 ;	user/ds1307.c: 22: data[2]=BIN2BCD(hour1);
      000061 1E 0A            [ 2]  136 	ldw	x, (0x0a, sp)
      000063 5C               [ 2]  137 	incw	x
      000064 5C               [ 2]  138 	incw	x
      000065 1F 0C            [ 2]  139 	ldw	(0x0c, sp), x
      000067 7B 18            [ 1]  140 	ld	a, (0x18, sp)
      000069 88               [ 1]  141 	push	a
      00006A CDr04rE2         [ 4]  142 	call	_BIN2BCD
      00006D 5B 01            [ 2]  143 	addw	sp, #1
      00006F 1E 0C            [ 2]  144 	ldw	x, (0x0c, sp)
      000071 F7               [ 1]  145 	ld	(x), a
                                    146 ;	user/ds1307.c: 23: data[3]=BIN2BCD(day1);
      000072 1E 0A            [ 2]  147 	ldw	x, (0x0a, sp)
      000074 1C 00 03         [ 2]  148 	addw	x, #0x0003
      000077 1F 08            [ 2]  149 	ldw	(0x08, sp), x
      000079 7B 1A            [ 1]  150 	ld	a, (0x1a, sp)
      00007B 88               [ 1]  151 	push	a
      00007C CDr04rE2         [ 4]  152 	call	_BIN2BCD
      00007F 5B 01            [ 2]  153 	addw	sp, #1
      000081 1E 08            [ 2]  154 	ldw	x, (0x08, sp)
      000083 F7               [ 1]  155 	ld	(x), a
                                    156 ;	user/ds1307.c: 24: data[4]=BIN2BCD(date1);
      000084 1E 0A            [ 2]  157 	ldw	x, (0x0a, sp)
      000086 1C 00 04         [ 2]  158 	addw	x, #0x0004
      000089 1F 12            [ 2]  159 	ldw	(0x12, sp), x
      00008B 7B 1B            [ 1]  160 	ld	a, (0x1b, sp)
      00008D 88               [ 1]  161 	push	a
      00008E CDr04rE2         [ 4]  162 	call	_BIN2BCD
      000091 5B 01            [ 2]  163 	addw	sp, #1
      000093 1E 12            [ 2]  164 	ldw	x, (0x12, sp)
      000095 F7               [ 1]  165 	ld	(x), a
                                    166 ;	user/ds1307.c: 25: data[5]=BIN2BCD(month1);
      000096 1E 0A            [ 2]  167 	ldw	x, (0x0a, sp)
      000098 1C 00 05         [ 2]  168 	addw	x, #0x0005
      00009B 1F 0E            [ 2]  169 	ldw	(0x0e, sp), x
      00009D 7B 1C            [ 1]  170 	ld	a, (0x1c, sp)
      00009F 88               [ 1]  171 	push	a
      0000A0 CDr04rE2         [ 4]  172 	call	_BIN2BCD
      0000A3 5B 01            [ 2]  173 	addw	sp, #1
      0000A5 1E 0E            [ 2]  174 	ldw	x, (0x0e, sp)
      0000A7 F7               [ 1]  175 	ld	(x), a
                                    176 ;	user/ds1307.c: 26: data[6]=BIN2BCD(year1);
      0000A8 1E 0A            [ 2]  177 	ldw	x, (0x0a, sp)
      0000AA 1C 00 06         [ 2]  178 	addw	x, #0x0006
      0000AD 1F 14            [ 2]  179 	ldw	(0x14, sp), x
      0000AF 7B 1D            [ 1]  180 	ld	a, (0x1d, sp)
      0000B1 88               [ 1]  181 	push	a
      0000B2 CDr04rE2         [ 4]  182 	call	_BIN2BCD
      0000B5 5B 01            [ 2]  183 	addw	sp, #1
      0000B7 1E 14            [ 2]  184 	ldw	x, (0x14, sp)
      0000B9 F7               [ 1]  185 	ld	(x), a
                                    186 ;	user/ds1307.c: 28: while(I2C_GetFlagStatus( I2C_FLAG_BUSBUSY)==SET);
      0000BA                        187 00101$:
      0000BA 4B 02            [ 1]  188 	push	#0x02
      0000BC 4B 03            [ 1]  189 	push	#0x03
      0000BE CDr00r00         [ 4]  190 	call	_I2C_GetFlagStatus
      0000C1 85               [ 2]  191 	popw	x
      0000C2 A1 01            [ 1]  192 	cp	a, #0x01
      0000C4 27 F4            [ 1]  193 	jreq	00101$
                                    194 ;	user/ds1307.c: 29: I2C_GenerateSTART(ENABLE);
      0000C6 4B 01            [ 1]  195 	push	#0x01
      0000C8 CDr00r00         [ 4]  196 	call	_I2C_GenerateSTART
      0000CB 84               [ 1]  197 	pop	a
                                    198 ;	user/ds1307.c: 32: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      0000CC                        199 00104$:
      0000CC 4B 01            [ 1]  200 	push	#0x01
      0000CE 4B 03            [ 1]  201 	push	#0x03
      0000D0 CDr00r00         [ 4]  202 	call	_I2C_CheckEvent
      0000D3 85               [ 2]  203 	popw	x
      0000D4 4D               [ 1]  204 	tnz	a
      0000D5 27 F5            [ 1]  205 	jreq	00104$
                                    206 ;	user/ds1307.c: 35: I2C_Send7bitAddress(DS1307_ADDR_WRITE,I2C_DIRECTION_TX);
      0000D7 4B 00            [ 1]  207 	push	#0x00
      0000D9 4B D0            [ 1]  208 	push	#0xd0
      0000DB CDr00r00         [ 4]  209 	call	_I2C_Send7bitAddress
      0000DE 85               [ 2]  210 	popw	x
                                    211 ;	user/ds1307.c: 38: while(!I2C_CheckEvent( I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));
      0000DF                        212 00107$:
      0000DF 4B 82            [ 1]  213 	push	#0x82
      0000E1 4B 07            [ 1]  214 	push	#0x07
      0000E3 CDr00r00         [ 4]  215 	call	_I2C_CheckEvent
      0000E6 85               [ 2]  216 	popw	x
      0000E7 4D               [ 1]  217 	tnz	a
      0000E8 27 F5            [ 1]  218 	jreq	00107$
                                    219 ;	user/ds1307.c: 42: I2C_SendData( 0x01);
      0000EA 4B 01            [ 1]  220 	push	#0x01
      0000EC CDr00r00         [ 4]  221 	call	_I2C_SendData
      0000EF 84               [ 1]  222 	pop	a
                                    223 ;	user/ds1307.c: 45: while(!I2C_CheckEvent( I2C_EVENT_MASTER_BYTE_TRANSMITTED));
      0000F0                        224 00110$:
      0000F0 4B 84            [ 1]  225 	push	#0x84
      0000F2 4B 07            [ 1]  226 	push	#0x07
      0000F4 CDr00r00         [ 4]  227 	call	_I2C_CheckEvent
      0000F7 85               [ 2]  228 	popw	x
      0000F8 4D               [ 1]  229 	tnz	a
      0000F9 27 F5            [ 1]  230 	jreq	00110$
                                    231 ;	user/ds1307.c: 49: I2C_SendData( data[1]);
      0000FB 1E 10            [ 2]  232 	ldw	x, (0x10, sp)
      0000FD F6               [ 1]  233 	ld	a, (x)
      0000FE 88               [ 1]  234 	push	a
      0000FF CDr00r00         [ 4]  235 	call	_I2C_SendData
      000102 84               [ 1]  236 	pop	a
                                    237 ;	user/ds1307.c: 52: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      000103                        238 00113$:
      000103 4B 04            [ 1]  239 	push	#0x04
      000105 4B 01            [ 1]  240 	push	#0x01
      000107 CDr00r00         [ 4]  241 	call	_I2C_GetFlagStatus
      00010A 85               [ 2]  242 	popw	x
      00010B 4D               [ 1]  243 	tnz	a
      00010C 27 F5            [ 1]  244 	jreq	00113$
                                    245 ;	user/ds1307.c: 55: I2C_SendData( data[2]);
      00010E 1E 0C            [ 2]  246 	ldw	x, (0x0c, sp)
      000110 F6               [ 1]  247 	ld	a, (x)
      000111 88               [ 1]  248 	push	a
      000112 CDr00r00         [ 4]  249 	call	_I2C_SendData
      000115 84               [ 1]  250 	pop	a
                                    251 ;	user/ds1307.c: 58: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      000116                        252 00116$:
      000116 4B 04            [ 1]  253 	push	#0x04
      000118 4B 01            [ 1]  254 	push	#0x01
      00011A CDr00r00         [ 4]  255 	call	_I2C_GetFlagStatus
      00011D 85               [ 2]  256 	popw	x
      00011E 4D               [ 1]  257 	tnz	a
      00011F 27 F5            [ 1]  258 	jreq	00116$
                                    259 ;	user/ds1307.c: 61: I2C_SendData( data[3]);
      000121 1E 08            [ 2]  260 	ldw	x, (0x08, sp)
      000123 F6               [ 1]  261 	ld	a, (x)
      000124 88               [ 1]  262 	push	a
      000125 CDr00r00         [ 4]  263 	call	_I2C_SendData
      000128 84               [ 1]  264 	pop	a
                                    265 ;	user/ds1307.c: 64: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      000129                        266 00119$:
      000129 4B 04            [ 1]  267 	push	#0x04
      00012B 4B 01            [ 1]  268 	push	#0x01
      00012D CDr00r00         [ 4]  269 	call	_I2C_GetFlagStatus
      000130 85               [ 2]  270 	popw	x
      000131 4D               [ 1]  271 	tnz	a
      000132 27 F5            [ 1]  272 	jreq	00119$
                                    273 ;	user/ds1307.c: 67: I2C_SendData( data[4]);
      000134 1E 12            [ 2]  274 	ldw	x, (0x12, sp)
      000136 F6               [ 1]  275 	ld	a, (x)
      000137 88               [ 1]  276 	push	a
      000138 CDr00r00         [ 4]  277 	call	_I2C_SendData
      00013B 84               [ 1]  278 	pop	a
                                    279 ;	user/ds1307.c: 70: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      00013C                        280 00122$:
      00013C 4B 04            [ 1]  281 	push	#0x04
      00013E 4B 01            [ 1]  282 	push	#0x01
      000140 CDr00r00         [ 4]  283 	call	_I2C_GetFlagStatus
      000143 85               [ 2]  284 	popw	x
      000144 4D               [ 1]  285 	tnz	a
      000145 27 F5            [ 1]  286 	jreq	00122$
                                    287 ;	user/ds1307.c: 73: I2C_SendData( data[5]);
      000147 1E 0E            [ 2]  288 	ldw	x, (0x0e, sp)
      000149 F6               [ 1]  289 	ld	a, (x)
      00014A 88               [ 1]  290 	push	a
      00014B CDr00r00         [ 4]  291 	call	_I2C_SendData
      00014E 84               [ 1]  292 	pop	a
                                    293 ;	user/ds1307.c: 76: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      00014F                        294 00125$:
      00014F 4B 04            [ 1]  295 	push	#0x04
      000151 4B 01            [ 1]  296 	push	#0x01
      000153 CDr00r00         [ 4]  297 	call	_I2C_GetFlagStatus
      000156 85               [ 2]  298 	popw	x
      000157 4D               [ 1]  299 	tnz	a
      000158 27 F5            [ 1]  300 	jreq	00125$
                                    301 ;	user/ds1307.c: 79: I2C_SendData( data[6]);
      00015A 1E 14            [ 2]  302 	ldw	x, (0x14, sp)
      00015C F6               [ 1]  303 	ld	a, (x)
      00015D 88               [ 1]  304 	push	a
      00015E CDr00r00         [ 4]  305 	call	_I2C_SendData
      000161 84               [ 1]  306 	pop	a
                                    307 ;	user/ds1307.c: 82: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      000162                        308 00128$:
      000162 4B 04            [ 1]  309 	push	#0x04
      000164 4B 01            [ 1]  310 	push	#0x01
      000166 CDr00r00         [ 4]  311 	call	_I2C_GetFlagStatus
      000169 85               [ 2]  312 	popw	x
      00016A 4D               [ 1]  313 	tnz	a
      00016B 27 F5            [ 1]  314 	jreq	00128$
                                    315 ;	user/ds1307.c: 85: I2C_GenerateSTOP(ENABLE);
      00016D 4B 01            [ 1]  316 	push	#0x01
      00016F CDr00r00         [ 4]  317 	call	_I2C_GenerateSTOP
      000172 84               [ 1]  318 	pop	a
                                    319 ;	user/ds1307.c: 88: I2C->SR1;		I2C->SR3;
      000173 AE 52 17         [ 2]  320 	ldw	x, #0x5217
      000176 F6               [ 1]  321 	ld	a, (x)
      000177 AE 52 19         [ 2]  322 	ldw	x, #0x5219
      00017A F6               [ 1]  323 	ld	a, (x)
      00017B 5B 15            [ 2]  324 	addw	sp, #21
      00017D 81               [ 4]  325 	ret
                                    326 ;	user/ds1307.c: 92: void DS1307_SetTime(DS1307_Time_t* time)
                                    327 ;	-----------------------------------------
                                    328 ;	 function DS1307_SetTime
                                    329 ;	-----------------------------------------
      00017E                        330 _DS1307_SetTime:
      00017E 52 17            [ 2]  331 	sub	sp, #23
                                    332 ;	user/ds1307.c: 95: data[0]=BIN2BCD(time->seconds);
      000180 96               [ 1]  333 	ldw	x, sp
      000181 5C               [ 2]  334 	incw	x
      000182 1F 0C            [ 2]  335 	ldw	(0x0c, sp), x
      000184 16 1A            [ 2]  336 	ldw	y, (0x1a, sp)
      000186 17 14            [ 2]  337 	ldw	(0x14, sp), y
      000188 1E 14            [ 2]  338 	ldw	x, (0x14, sp)
      00018A F6               [ 1]  339 	ld	a, (x)
      00018B 88               [ 1]  340 	push	a
      00018C CDr04rE2         [ 4]  341 	call	_BIN2BCD
      00018F 5B 01            [ 2]  342 	addw	sp, #1
      000191 1E 0C            [ 2]  343 	ldw	x, (0x0c, sp)
      000193 F7               [ 1]  344 	ld	(x), a
                                    345 ;	user/ds1307.c: 96: data[1]=BIN2BCD(time->minutes);
      000194 1E 0C            [ 2]  346 	ldw	x, (0x0c, sp)
      000196 5C               [ 2]  347 	incw	x
      000197 1F 12            [ 2]  348 	ldw	(0x12, sp), x
      000199 1E 14            [ 2]  349 	ldw	x, (0x14, sp)
      00019B E6 01            [ 1]  350 	ld	a, (0x1, x)
      00019D 88               [ 1]  351 	push	a
      00019E CDr04rE2         [ 4]  352 	call	_BIN2BCD
      0001A1 5B 01            [ 2]  353 	addw	sp, #1
      0001A3 1E 12            [ 2]  354 	ldw	x, (0x12, sp)
      0001A5 F7               [ 1]  355 	ld	(x), a
                                    356 ;	user/ds1307.c: 97: data[2]=BIN2BCD(time->hours);
      0001A6 1E 0C            [ 2]  357 	ldw	x, (0x0c, sp)
      0001A8 5C               [ 2]  358 	incw	x
      0001A9 5C               [ 2]  359 	incw	x
      0001AA 1F 0E            [ 2]  360 	ldw	(0x0e, sp), x
      0001AC 1E 14            [ 2]  361 	ldw	x, (0x14, sp)
      0001AE E6 02            [ 1]  362 	ld	a, (0x2, x)
      0001B0 88               [ 1]  363 	push	a
      0001B1 CDr04rE2         [ 4]  364 	call	_BIN2BCD
      0001B4 5B 01            [ 2]  365 	addw	sp, #1
      0001B6 1E 0E            [ 2]  366 	ldw	x, (0x0e, sp)
      0001B8 F7               [ 1]  367 	ld	(x), a
                                    368 ;	user/ds1307.c: 98: data[3]=BIN2BCD(time->day);
      0001B9 1E 0C            [ 2]  369 	ldw	x, (0x0c, sp)
      0001BB 1C 00 03         [ 2]  370 	addw	x, #0x0003
      0001BE 1F 16            [ 2]  371 	ldw	(0x16, sp), x
      0001C0 1E 14            [ 2]  372 	ldw	x, (0x14, sp)
      0001C2 E6 03            [ 1]  373 	ld	a, (0x3, x)
      0001C4 88               [ 1]  374 	push	a
      0001C5 CDr04rE2         [ 4]  375 	call	_BIN2BCD
      0001C8 5B 01            [ 2]  376 	addw	sp, #1
      0001CA 1E 16            [ 2]  377 	ldw	x, (0x16, sp)
      0001CC F7               [ 1]  378 	ld	(x), a
                                    379 ;	user/ds1307.c: 99: data[4]=BIN2BCD(time->date);
      0001CD 1E 0C            [ 2]  380 	ldw	x, (0x0c, sp)
      0001CF 1C 00 04         [ 2]  381 	addw	x, #0x0004
      0001D2 1F 0A            [ 2]  382 	ldw	(0x0a, sp), x
      0001D4 1E 14            [ 2]  383 	ldw	x, (0x14, sp)
      0001D6 E6 04            [ 1]  384 	ld	a, (0x4, x)
      0001D8 88               [ 1]  385 	push	a
      0001D9 CDr04rE2         [ 4]  386 	call	_BIN2BCD
      0001DC 5B 01            [ 2]  387 	addw	sp, #1
      0001DE 1E 0A            [ 2]  388 	ldw	x, (0x0a, sp)
      0001E0 F7               [ 1]  389 	ld	(x), a
                                    390 ;	user/ds1307.c: 100: data[5]=BIN2BCD(time->month);
      0001E1 1E 0C            [ 2]  391 	ldw	x, (0x0c, sp)
      0001E3 1C 00 05         [ 2]  392 	addw	x, #0x0005
      0001E6 1F 10            [ 2]  393 	ldw	(0x10, sp), x
      0001E8 1E 14            [ 2]  394 	ldw	x, (0x14, sp)
      0001EA E6 05            [ 1]  395 	ld	a, (0x5, x)
      0001EC 88               [ 1]  396 	push	a
      0001ED CDr04rE2         [ 4]  397 	call	_BIN2BCD
      0001F0 5B 01            [ 2]  398 	addw	sp, #1
      0001F2 1E 10            [ 2]  399 	ldw	x, (0x10, sp)
      0001F4 F7               [ 1]  400 	ld	(x), a
                                    401 ;	user/ds1307.c: 101: data[6]=BIN2BCD(time->year);
      0001F5 1E 0C            [ 2]  402 	ldw	x, (0x0c, sp)
      0001F7 1C 00 06         [ 2]  403 	addw	x, #0x0006
      0001FA 1F 08            [ 2]  404 	ldw	(0x08, sp), x
      0001FC 1E 14            [ 2]  405 	ldw	x, (0x14, sp)
      0001FE E6 06            [ 1]  406 	ld	a, (0x6, x)
      000200 88               [ 1]  407 	push	a
      000201 CDr04rE2         [ 4]  408 	call	_BIN2BCD
      000204 5B 01            [ 2]  409 	addw	sp, #1
      000206 1E 08            [ 2]  410 	ldw	x, (0x08, sp)
      000208 F7               [ 1]  411 	ld	(x), a
                                    412 ;	user/ds1307.c: 103: while(I2C_GetFlagStatus( I2C_FLAG_BUSBUSY)==SET);
      000209                        413 00101$:
      000209 4B 02            [ 1]  414 	push	#0x02
      00020B 4B 03            [ 1]  415 	push	#0x03
      00020D CDr00r00         [ 4]  416 	call	_I2C_GetFlagStatus
      000210 85               [ 2]  417 	popw	x
      000211 A1 01            [ 1]  418 	cp	a, #0x01
      000213 27 F4            [ 1]  419 	jreq	00101$
                                    420 ;	user/ds1307.c: 104: I2C_GenerateSTART(ENABLE);
      000215 4B 01            [ 1]  421 	push	#0x01
      000217 CDr00r00         [ 4]  422 	call	_I2C_GenerateSTART
      00021A 84               [ 1]  423 	pop	a
                                    424 ;	user/ds1307.c: 107: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      00021B                        425 00104$:
      00021B 4B 01            [ 1]  426 	push	#0x01
      00021D 4B 03            [ 1]  427 	push	#0x03
      00021F CDr00r00         [ 4]  428 	call	_I2C_CheckEvent
      000222 85               [ 2]  429 	popw	x
      000223 4D               [ 1]  430 	tnz	a
      000224 27 F5            [ 1]  431 	jreq	00104$
                                    432 ;	user/ds1307.c: 110: I2C_Send7bitAddress((uint8_t)DS1307_ADDR_WRITE,I2C_DIRECTION_TX);
      000226 4B 00            [ 1]  433 	push	#0x00
      000228 4B D0            [ 1]  434 	push	#0xd0
      00022A CDr00r00         [ 4]  435 	call	_I2C_Send7bitAddress
      00022D 85               [ 2]  436 	popw	x
                                    437 ;	user/ds1307.c: 113: while(!I2C_CheckEvent( I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));
      00022E                        438 00107$:
      00022E 4B 82            [ 1]  439 	push	#0x82
      000230 4B 07            [ 1]  440 	push	#0x07
      000232 CDr00r00         [ 4]  441 	call	_I2C_CheckEvent
      000235 85               [ 2]  442 	popw	x
      000236 4D               [ 1]  443 	tnz	a
      000237 27 F5            [ 1]  444 	jreq	00107$
                                    445 ;	user/ds1307.c: 116: I2C_SendData( 0x01);
      000239 4B 01            [ 1]  446 	push	#0x01
      00023B CDr00r00         [ 4]  447 	call	_I2C_SendData
      00023E 84               [ 1]  448 	pop	a
                                    449 ;	user/ds1307.c: 119: while(!I2C_CheckEvent( I2C_EVENT_MASTER_BYTE_TRANSMITTED));
      00023F                        450 00110$:
      00023F 4B 84            [ 1]  451 	push	#0x84
      000241 4B 07            [ 1]  452 	push	#0x07
      000243 CDr00r00         [ 4]  453 	call	_I2C_CheckEvent
      000246 85               [ 2]  454 	popw	x
      000247 4D               [ 1]  455 	tnz	a
      000248 27 F5            [ 1]  456 	jreq	00110$
                                    457 ;	user/ds1307.c: 123: I2C_SendData( data[1]);
      00024A 1E 12            [ 2]  458 	ldw	x, (0x12, sp)
      00024C F6               [ 1]  459 	ld	a, (x)
      00024D 88               [ 1]  460 	push	a
      00024E CDr00r00         [ 4]  461 	call	_I2C_SendData
      000251 84               [ 1]  462 	pop	a
                                    463 ;	user/ds1307.c: 126: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      000252                        464 00113$:
      000252 4B 04            [ 1]  465 	push	#0x04
      000254 4B 01            [ 1]  466 	push	#0x01
      000256 CDr00r00         [ 4]  467 	call	_I2C_GetFlagStatus
      000259 85               [ 2]  468 	popw	x
      00025A 4D               [ 1]  469 	tnz	a
      00025B 27 F5            [ 1]  470 	jreq	00113$
                                    471 ;	user/ds1307.c: 129: I2C_SendData( data[2]);
      00025D 1E 0E            [ 2]  472 	ldw	x, (0x0e, sp)
      00025F F6               [ 1]  473 	ld	a, (x)
      000260 88               [ 1]  474 	push	a
      000261 CDr00r00         [ 4]  475 	call	_I2C_SendData
      000264 84               [ 1]  476 	pop	a
                                    477 ;	user/ds1307.c: 132: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      000265                        478 00116$:
      000265 4B 04            [ 1]  479 	push	#0x04
      000267 4B 01            [ 1]  480 	push	#0x01
      000269 CDr00r00         [ 4]  481 	call	_I2C_GetFlagStatus
      00026C 85               [ 2]  482 	popw	x
      00026D 4D               [ 1]  483 	tnz	a
      00026E 27 F5            [ 1]  484 	jreq	00116$
                                    485 ;	user/ds1307.c: 135: I2C_SendData( data[3]);
      000270 1E 16            [ 2]  486 	ldw	x, (0x16, sp)
      000272 F6               [ 1]  487 	ld	a, (x)
      000273 88               [ 1]  488 	push	a
      000274 CDr00r00         [ 4]  489 	call	_I2C_SendData
      000277 84               [ 1]  490 	pop	a
                                    491 ;	user/ds1307.c: 138: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      000278                        492 00119$:
      000278 4B 04            [ 1]  493 	push	#0x04
      00027A 4B 01            [ 1]  494 	push	#0x01
      00027C CDr00r00         [ 4]  495 	call	_I2C_GetFlagStatus
      00027F 85               [ 2]  496 	popw	x
      000280 4D               [ 1]  497 	tnz	a
      000281 27 F5            [ 1]  498 	jreq	00119$
                                    499 ;	user/ds1307.c: 141: I2C_SendData( data[4]);
      000283 1E 0A            [ 2]  500 	ldw	x, (0x0a, sp)
      000285 F6               [ 1]  501 	ld	a, (x)
      000286 88               [ 1]  502 	push	a
      000287 CDr00r00         [ 4]  503 	call	_I2C_SendData
      00028A 84               [ 1]  504 	pop	a
                                    505 ;	user/ds1307.c: 144: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      00028B                        506 00122$:
      00028B 4B 04            [ 1]  507 	push	#0x04
      00028D 4B 01            [ 1]  508 	push	#0x01
      00028F CDr00r00         [ 4]  509 	call	_I2C_GetFlagStatus
      000292 85               [ 2]  510 	popw	x
      000293 4D               [ 1]  511 	tnz	a
      000294 27 F5            [ 1]  512 	jreq	00122$
                                    513 ;	user/ds1307.c: 147: I2C_SendData( data[5]);
      000296 1E 10            [ 2]  514 	ldw	x, (0x10, sp)
      000298 F6               [ 1]  515 	ld	a, (x)
      000299 88               [ 1]  516 	push	a
      00029A CDr00r00         [ 4]  517 	call	_I2C_SendData
      00029D 84               [ 1]  518 	pop	a
                                    519 ;	user/ds1307.c: 150: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      00029E                        520 00125$:
      00029E 4B 04            [ 1]  521 	push	#0x04
      0002A0 4B 01            [ 1]  522 	push	#0x01
      0002A2 CDr00r00         [ 4]  523 	call	_I2C_GetFlagStatus
      0002A5 85               [ 2]  524 	popw	x
      0002A6 4D               [ 1]  525 	tnz	a
      0002A7 27 F5            [ 1]  526 	jreq	00125$
                                    527 ;	user/ds1307.c: 153: I2C_SendData( data[6]);
      0002A9 1E 08            [ 2]  528 	ldw	x, (0x08, sp)
      0002AB F6               [ 1]  529 	ld	a, (x)
      0002AC 88               [ 1]  530 	push	a
      0002AD CDr00r00         [ 4]  531 	call	_I2C_SendData
      0002B0 84               [ 1]  532 	pop	a
                                    533 ;	user/ds1307.c: 156: while(!I2C_GetFlagStatus( I2C_FLAG_TRANSFERFINISHED));
      0002B1                        534 00128$:
      0002B1 4B 04            [ 1]  535 	push	#0x04
      0002B3 4B 01            [ 1]  536 	push	#0x01
      0002B5 CDr00r00         [ 4]  537 	call	_I2C_GetFlagStatus
      0002B8 85               [ 2]  538 	popw	x
      0002B9 4D               [ 1]  539 	tnz	a
      0002BA 27 F5            [ 1]  540 	jreq	00128$
                                    541 ;	user/ds1307.c: 159: I2C_GenerateSTOP(ENABLE);
      0002BC 4B 01            [ 1]  542 	push	#0x01
      0002BE CDr00r00         [ 4]  543 	call	_I2C_GenerateSTOP
      0002C1 84               [ 1]  544 	pop	a
                                    545 ;	user/ds1307.c: 162: I2C->SR1;        I2C->SR3;
      0002C2 AE 52 17         [ 2]  546 	ldw	x, #0x5217
      0002C5 F6               [ 1]  547 	ld	a, (x)
      0002C6 AE 52 19         [ 2]  548 	ldw	x, #0x5219
      0002C9 F6               [ 1]  549 	ld	a, (x)
      0002CA 5B 17            [ 2]  550 	addw	sp, #23
      0002CC 81               [ 4]  551 	ret
                                    552 ;	user/ds1307.c: 165: void DS1307_GetDateTime(DS1307_Time_t* time) {
                                    553 ;	-----------------------------------------
                                    554 ;	 function DS1307_GetDateTime
                                    555 ;	-----------------------------------------
      0002CD                        556 _DS1307_GetDateTime:
      0002CD 52 18            [ 2]  557 	sub	sp, #24
                                    558 ;	user/ds1307.c: 168: for(i=0;i<8;i++)
      0002CF 96               [ 1]  559 	ldw	x, sp
      0002D0 5C               [ 2]  560 	incw	x
      0002D1 1F 15            [ 2]  561 	ldw	(0x15, sp), x
      0002D3 0F 08            [ 1]  562 	clr	(0x08, sp)
      0002D5                        563 00105$:
                                    564 ;	user/ds1307.c: 170: data[i]=read_ds1307(i);
      0002D5 5F               [ 1]  565 	clrw	x
      0002D6 7B 08            [ 1]  566 	ld	a, (0x08, sp)
      0002D8 97               [ 1]  567 	ld	xl, a
      0002D9 72 FB 15         [ 2]  568 	addw	x, (0x15, sp)
      0002DC 89               [ 2]  569 	pushw	x
      0002DD 7B 0A            [ 1]  570 	ld	a, (0x0a, sp)
      0002DF 88               [ 1]  571 	push	a
      0002E0 CDr04r2C         [ 4]  572 	call	_read_ds1307
      0002E3 5B 01            [ 2]  573 	addw	sp, #1
      0002E5 85               [ 2]  574 	popw	x
      0002E6 F7               [ 1]  575 	ld	(x), a
                                    576 ;	user/ds1307.c: 168: for(i=0;i<8;i++)
      0002E7 0C 08            [ 1]  577 	inc	(0x08, sp)
      0002E9 7B 08            [ 1]  578 	ld	a, (0x08, sp)
      0002EB A1 08            [ 1]  579 	cp	a, #0x08
      0002ED 25 E6            [ 1]  580 	jrc	00105$
                                    581 ;	user/ds1307.c: 173: time->seconds = BCD2BIN(data[0]&=0x7F);
      0002EF 16 1B            [ 2]  582 	ldw	y, (0x1b, sp)
      0002F1 17 0F            [ 2]  583 	ldw	(0x0f, sp), y
      0002F3 1E 15            [ 2]  584 	ldw	x, (0x15, sp)
      0002F5 F6               [ 1]  585 	ld	a, (x)
      0002F6 A4 7F            [ 1]  586 	and	a, #0x7f
      0002F8 1E 15            [ 2]  587 	ldw	x, (0x15, sp)
      0002FA F7               [ 1]  588 	ld	(x), a
      0002FB 88               [ 1]  589 	push	a
      0002FC CDr04rCA         [ 4]  590 	call	_BCD2BIN
      0002FF 5B 01            [ 2]  591 	addw	sp, #1
      000301 1E 0F            [ 2]  592 	ldw	x, (0x0f, sp)
      000303 F7               [ 1]  593 	ld	(x), a
                                    594 ;	user/ds1307.c: 175: time->minutes = BCD2BIN(data[1]&=0x7F);
      000304 1E 0F            [ 2]  595 	ldw	x, (0x0f, sp)
      000306 5C               [ 2]  596 	incw	x
      000307 1F 17            [ 2]  597 	ldw	(0x17, sp), x
      000309 1E 15            [ 2]  598 	ldw	x, (0x15, sp)
      00030B 5C               [ 2]  599 	incw	x
      00030C F6               [ 1]  600 	ld	a, (x)
      00030D A4 7F            [ 1]  601 	and	a, #0x7f
      00030F F7               [ 1]  602 	ld	(x), a
      000310 89               [ 2]  603 	pushw	x
      000311 88               [ 1]  604 	push	a
      000312 CDr04rCA         [ 4]  605 	call	_BCD2BIN
      000315 5B 01            [ 2]  606 	addw	sp, #1
      000317 85               [ 2]  607 	popw	x
      000318 16 17            [ 2]  608 	ldw	y, (0x17, sp)
      00031A 90 F7            [ 1]  609 	ld	(y), a
                                    610 ;	user/ds1307.c: 177: if((data[1]&0x40)!=0)    time->hours=BCD2BIN(data[2]&=0x1F);
      00031C F6               [ 1]  611 	ld	a, (x)
      00031D 90 97            [ 1]  612 	ld	yl, a
      00031F 1E 0F            [ 2]  613 	ldw	x, (0x0f, sp)
      000321 5C               [ 2]  614 	incw	x
      000322 5C               [ 2]  615 	incw	x
      000323 1F 09            [ 2]  616 	ldw	(0x09, sp), x
      000325 1E 15            [ 2]  617 	ldw	x, (0x15, sp)
      000327 5C               [ 2]  618 	incw	x
      000328 5C               [ 2]  619 	incw	x
      000329 F6               [ 1]  620 	ld	a, (x)
      00032A 88               [ 1]  621 	push	a
      00032B 90 9F            [ 1]  622 	ld	a, yl
      00032D A5 40            [ 1]  623 	bcp	a, #0x40
      00032F 84               [ 1]  624 	pop	a
      000330 27 0E            [ 1]  625 	jreq	00103$
      000332 A4 1F            [ 1]  626 	and	a, #0x1f
      000334 F7               [ 1]  627 	ld	(x), a
      000335 88               [ 1]  628 	push	a
      000336 CDr04rCA         [ 4]  629 	call	_BCD2BIN
      000339 5B 01            [ 2]  630 	addw	sp, #1
      00033B 1E 09            [ 2]  631 	ldw	x, (0x09, sp)
      00033D F7               [ 1]  632 	ld	(x), a
      00033E 20 0C            [ 2]  633 	jra	00104$
      000340                        634 00103$:
                                    635 ;	user/ds1307.c: 178: else time->hours=BCD2BIN(data[2]&=0x3F);
      000340 A4 3F            [ 1]  636 	and	a, #0x3f
      000342 F7               [ 1]  637 	ld	(x), a
      000343 88               [ 1]  638 	push	a
      000344 CDr04rCA         [ 4]  639 	call	_BCD2BIN
      000347 5B 01            [ 2]  640 	addw	sp, #1
      000349 1E 09            [ 2]  641 	ldw	x, (0x09, sp)
      00034B F7               [ 1]  642 	ld	(x), a
      00034C                        643 00104$:
                                    644 ;	user/ds1307.c: 180: time->day = BCD2BIN(data[3]&=0x07);
      00034C 1E 0F            [ 2]  645 	ldw	x, (0x0f, sp)
      00034E 1C 00 03         [ 2]  646 	addw	x, #0x0003
      000351 1F 13            [ 2]  647 	ldw	(0x13, sp), x
      000353 1E 15            [ 2]  648 	ldw	x, (0x15, sp)
      000355 1C 00 03         [ 2]  649 	addw	x, #0x0003
      000358 F6               [ 1]  650 	ld	a, (x)
      000359 A4 07            [ 1]  651 	and	a, #0x07
      00035B F7               [ 1]  652 	ld	(x), a
      00035C 88               [ 1]  653 	push	a
      00035D CDr04rCA         [ 4]  654 	call	_BCD2BIN
      000360 5B 01            [ 2]  655 	addw	sp, #1
      000362 1E 13            [ 2]  656 	ldw	x, (0x13, sp)
      000364 F7               [ 1]  657 	ld	(x), a
                                    658 ;	user/ds1307.c: 181: time->date = BCD2BIN(data[4]&=0x3F);
      000365 1E 0F            [ 2]  659 	ldw	x, (0x0f, sp)
      000367 1C 00 04         [ 2]  660 	addw	x, #0x0004
      00036A 1F 0D            [ 2]  661 	ldw	(0x0d, sp), x
      00036C 1E 15            [ 2]  662 	ldw	x, (0x15, sp)
      00036E 1C 00 04         [ 2]  663 	addw	x, #0x0004
      000371 F6               [ 1]  664 	ld	a, (x)
      000372 A4 3F            [ 1]  665 	and	a, #0x3f
      000374 F7               [ 1]  666 	ld	(x), a
      000375 88               [ 1]  667 	push	a
      000376 CDr04rCA         [ 4]  668 	call	_BCD2BIN
      000379 5B 01            [ 2]  669 	addw	sp, #1
      00037B 1E 0D            [ 2]  670 	ldw	x, (0x0d, sp)
      00037D F7               [ 1]  671 	ld	(x), a
                                    672 ;	user/ds1307.c: 182: time->month = BCD2BIN(data[5]&=0x1F);
      00037E 1E 0F            [ 2]  673 	ldw	x, (0x0f, sp)
      000380 1C 00 05         [ 2]  674 	addw	x, #0x0005
      000383 1F 11            [ 2]  675 	ldw	(0x11, sp), x
      000385 1E 15            [ 2]  676 	ldw	x, (0x15, sp)
      000387 1C 00 05         [ 2]  677 	addw	x, #0x0005
      00038A F6               [ 1]  678 	ld	a, (x)
      00038B A4 1F            [ 1]  679 	and	a, #0x1f
      00038D F7               [ 1]  680 	ld	(x), a
      00038E 88               [ 1]  681 	push	a
      00038F CDr04rCA         [ 4]  682 	call	_BCD2BIN
      000392 5B 01            [ 2]  683 	addw	sp, #1
      000394 1E 11            [ 2]  684 	ldw	x, (0x11, sp)
      000396 F7               [ 1]  685 	ld	(x), a
                                    686 ;	user/ds1307.c: 183: time->year = BCD2BIN(data[6]&=0xFF);
      000397 1E 0F            [ 2]  687 	ldw	x, (0x0f, sp)
      000399 1C 00 06         [ 2]  688 	addw	x, #0x0006
      00039C 1F 0B            [ 2]  689 	ldw	(0x0b, sp), x
      00039E 1E 15            [ 2]  690 	ldw	x, (0x15, sp)
      0003A0 1C 00 06         [ 2]  691 	addw	x, #0x0006
      0003A3 F6               [ 1]  692 	ld	a, (x)
      0003A4 F7               [ 1]  693 	ld	(x), a
      0003A5 88               [ 1]  694 	push	a
      0003A6 CDr04rCA         [ 4]  695 	call	_BCD2BIN
      0003A9 5B 01            [ 2]  696 	addw	sp, #1
      0003AB 1E 0B            [ 2]  697 	ldw	x, (0x0b, sp)
      0003AD F7               [ 1]  698 	ld	(x), a
      0003AE 5B 18            [ 2]  699 	addw	sp, #24
      0003B0 81               [ 4]  700 	ret
                                    701 ;	user/ds1307.c: 187: unsigned char DS1307_GetSeconds(void)
                                    702 ;	-----------------------------------------
                                    703 ;	 function DS1307_GetSeconds
                                    704 ;	-----------------------------------------
      0003B1                        705 _DS1307_GetSeconds:
                                    706 ;	user/ds1307.c: 190: sec=read_ds1307(0x00);
      0003B1 4B 00            [ 1]  707 	push	#0x00
      0003B3 CDr04r2C         [ 4]  708 	call	_read_ds1307
      0003B6 5B 01            [ 2]  709 	addw	sp, #1
                                    710 ;	user/ds1307.c: 191: sec=BCD2BIN(sec&=0x7F);
      0003B8 A4 7F            [ 1]  711 	and	a, #0x7f
      0003BA 88               [ 1]  712 	push	a
      0003BB CDr04rCA         [ 4]  713 	call	_BCD2BIN
      0003BE 5B 01            [ 2]  714 	addw	sp, #1
                                    715 ;	user/ds1307.c: 192: return sec;
      0003C0 81               [ 4]  716 	ret
                                    717 ;	user/ds1307.c: 194: unsigned char DS1307_GetMinutes(void)
                                    718 ;	-----------------------------------------
                                    719 ;	 function DS1307_GetMinutes
                                    720 ;	-----------------------------------------
      0003C1                        721 _DS1307_GetMinutes:
                                    722 ;	user/ds1307.c: 197: min=read_ds1307(0x01);
      0003C1 4B 01            [ 1]  723 	push	#0x01
      0003C3 CDr04r2C         [ 4]  724 	call	_read_ds1307
      0003C6 5B 01            [ 2]  725 	addw	sp, #1
                                    726 ;	user/ds1307.c: 198: min=BCD2BIN(min&=0x7F);
      0003C8 A4 7F            [ 1]  727 	and	a, #0x7f
      0003CA 88               [ 1]  728 	push	a
      0003CB CDr04rCA         [ 4]  729 	call	_BCD2BIN
      0003CE 5B 01            [ 2]  730 	addw	sp, #1
                                    731 ;	user/ds1307.c: 199: return min;
      0003D0 81               [ 4]  732 	ret
                                    733 ;	user/ds1307.c: 201: unsigned char DS1307_GetHours(void)
                                    734 ;	-----------------------------------------
                                    735 ;	 function DS1307_GetHours
                                    736 ;	-----------------------------------------
      0003D1                        737 _DS1307_GetHours:
                                    738 ;	user/ds1307.c: 204: hour=read_ds1307(0x02);
      0003D1 4B 02            [ 1]  739 	push	#0x02
      0003D3 CDr04r2C         [ 4]  740 	call	_read_ds1307
      0003D6 5B 01            [ 2]  741 	addw	sp, #1
                                    742 ;	user/ds1307.c: 205: if((hour&0x40)!=0)    hour=BCD2BIN(hour&=0x1F);
      0003D8 A5 40            [ 1]  743 	bcp	a, #0x40
      0003DA 27 09            [ 1]  744 	jreq	00102$
      0003DC A4 1F            [ 1]  745 	and	a, #0x1f
      0003DE 88               [ 1]  746 	push	a
      0003DF CDr04rCA         [ 4]  747 	call	_BCD2BIN
      0003E2 5B 01            [ 2]  748 	addw	sp, #1
      0003E4 81               [ 4]  749 	ret
      0003E5                        750 00102$:
                                    751 ;	user/ds1307.c: 206: else hour=BCD2BIN(hour&=0x3F);
      0003E5 A4 3F            [ 1]  752 	and	a, #0x3f
      0003E7 88               [ 1]  753 	push	a
      0003E8 CDr04rCA         [ 4]  754 	call	_BCD2BIN
      0003EB 5B 01            [ 2]  755 	addw	sp, #1
                                    756 ;	user/ds1307.c: 207: return hour;
      0003ED 81               [ 4]  757 	ret
                                    758 ;	user/ds1307.c: 209: unsigned char DS1307_GetDay(void)
                                    759 ;	-----------------------------------------
                                    760 ;	 function DS1307_GetDay
                                    761 ;	-----------------------------------------
      0003EE                        762 _DS1307_GetDay:
                                    763 ;	user/ds1307.c: 212: day=read_ds1307(0x03);
      0003EE 4B 03            [ 1]  764 	push	#0x03
      0003F0 CDr04r2C         [ 4]  765 	call	_read_ds1307
      0003F3 5B 01            [ 2]  766 	addw	sp, #1
                                    767 ;	user/ds1307.c: 213: day=BCD2BIN(day&=0x07);
      0003F5 A4 07            [ 1]  768 	and	a, #0x07
      0003F7 88               [ 1]  769 	push	a
      0003F8 CDr04rCA         [ 4]  770 	call	_BCD2BIN
      0003FB 5B 01            [ 2]  771 	addw	sp, #1
                                    772 ;	user/ds1307.c: 214: return day;
      0003FD 81               [ 4]  773 	ret
                                    774 ;	user/ds1307.c: 216: unsigned char DS1307_GetDate(void)
                                    775 ;	-----------------------------------------
                                    776 ;	 function DS1307_GetDate
                                    777 ;	-----------------------------------------
      0003FE                        778 _DS1307_GetDate:
                                    779 ;	user/ds1307.c: 219: date=read_ds1307(0x04);
      0003FE 4B 04            [ 1]  780 	push	#0x04
      000400 CDr04r2C         [ 4]  781 	call	_read_ds1307
      000403 5B 01            [ 2]  782 	addw	sp, #1
                                    783 ;	user/ds1307.c: 220: date=BCD2BIN(date&=0x3F);
      000405 A4 3F            [ 1]  784 	and	a, #0x3f
      000407 88               [ 1]  785 	push	a
      000408 CDr04rCA         [ 4]  786 	call	_BCD2BIN
      00040B 5B 01            [ 2]  787 	addw	sp, #1
                                    788 ;	user/ds1307.c: 221: return date;
      00040D 81               [ 4]  789 	ret
                                    790 ;	user/ds1307.c: 223: unsigned char DS1307_GetMonth(void)
                                    791 ;	-----------------------------------------
                                    792 ;	 function DS1307_GetMonth
                                    793 ;	-----------------------------------------
      00040E                        794 _DS1307_GetMonth:
                                    795 ;	user/ds1307.c: 226: month=read_ds1307(0x05);
      00040E 4B 05            [ 1]  796 	push	#0x05
      000410 CDr04r2C         [ 4]  797 	call	_read_ds1307
      000413 5B 01            [ 2]  798 	addw	sp, #1
                                    799 ;	user/ds1307.c: 227: month=BCD2BIN(month&=0x1F);
      000415 A4 1F            [ 1]  800 	and	a, #0x1f
      000417 88               [ 1]  801 	push	a
      000418 CDr04rCA         [ 4]  802 	call	_BCD2BIN
      00041B 5B 01            [ 2]  803 	addw	sp, #1
                                    804 ;	user/ds1307.c: 228: return month;
      00041D 81               [ 4]  805 	ret
                                    806 ;	user/ds1307.c: 230: unsigned char DS1307_GetYear(void)
                                    807 ;	-----------------------------------------
                                    808 ;	 function DS1307_GetYear
                                    809 ;	-----------------------------------------
      00041E                        810 _DS1307_GetYear:
                                    811 ;	user/ds1307.c: 233: year=read_ds1307(0x06);
      00041E 4B 06            [ 1]  812 	push	#0x06
      000420 CDr04r2C         [ 4]  813 	call	_read_ds1307
      000423 5B 01            [ 2]  814 	addw	sp, #1
                                    815 ;	user/ds1307.c: 234: year=BCD2BIN(year&=0xFF);
      000425 88               [ 1]  816 	push	a
      000426 CDr04rCA         [ 4]  817 	call	_BCD2BIN
      000429 5B 01            [ 2]  818 	addw	sp, #1
                                    819 ;	user/ds1307.c: 235: return year;
      00042B 81               [ 4]  820 	ret
                                    821 ;	user/ds1307.c: 238: unsigned char read_ds1307(unsigned char regadd)
                                    822 ;	-----------------------------------------
                                    823 ;	 function read_ds1307
                                    824 ;	-----------------------------------------
      00042C                        825 _read_ds1307:
      00042C 88               [ 1]  826 	push	a
                                    827 ;	user/ds1307.c: 242: while(I2C_GetFlagStatus( I2C_FLAG_BUSBUSY)==SET);
      00042D                        828 00101$:
      00042D 4B 02            [ 1]  829 	push	#0x02
      00042F 4B 03            [ 1]  830 	push	#0x03
      000431 CDr00r00         [ 4]  831 	call	_I2C_GetFlagStatus
      000434 85               [ 2]  832 	popw	x
      000435 A1 01            [ 1]  833 	cp	a, #0x01
      000437 27 F4            [ 1]  834 	jreq	00101$
                                    835 ;	user/ds1307.c: 244: I2C_GenerateSTART(ENABLE);
      000439 4B 01            [ 1]  836 	push	#0x01
      00043B CDr00r00         [ 4]  837 	call	_I2C_GenerateSTART
      00043E 84               [ 1]  838 	pop	a
                                    839 ;	user/ds1307.c: 247: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      00043F                        840 00104$:
      00043F 4B 01            [ 1]  841 	push	#0x01
      000441 4B 03            [ 1]  842 	push	#0x03
      000443 CDr00r00         [ 4]  843 	call	_I2C_CheckEvent
      000446 85               [ 2]  844 	popw	x
      000447 4D               [ 1]  845 	tnz	a
      000448 27 F5            [ 1]  846 	jreq	00104$
                                    847 ;	user/ds1307.c: 250: I2C_Send7bitAddress(0xD0,I2C_DIRECTION_TX);
      00044A 4B 00            [ 1]  848 	push	#0x00
      00044C 4B D0            [ 1]  849 	push	#0xd0
      00044E CDr00r00         [ 4]  850 	call	_I2C_Send7bitAddress
      000451 85               [ 2]  851 	popw	x
                                    852 ;	user/ds1307.c: 251: while(!I2C_CheckEvent( I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));
      000452                        853 00107$:
      000452 4B 82            [ 1]  854 	push	#0x82
      000454 4B 07            [ 1]  855 	push	#0x07
      000456 CDr00r00         [ 4]  856 	call	_I2C_CheckEvent
      000459 85               [ 2]  857 	popw	x
      00045A 4D               [ 1]  858 	tnz	a
      00045B 27 F5            [ 1]  859 	jreq	00107$
                                    860 ;	user/ds1307.c: 254: I2C_SendData(regadd);
      00045D 7B 04            [ 1]  861 	ld	a, (0x04, sp)
      00045F 88               [ 1]  862 	push	a
      000460 CDr00r00         [ 4]  863 	call	_I2C_SendData
      000463 84               [ 1]  864 	pop	a
                                    865 ;	user/ds1307.c: 255: while(I2C_GetFlagStatus(I2C_FLAG_TRANSFERFINISHED) == RESET);
      000464                        866 00110$:
      000464 4B 04            [ 1]  867 	push	#0x04
      000466 4B 01            [ 1]  868 	push	#0x01
      000468 CDr00r00         [ 4]  869 	call	_I2C_GetFlagStatus
      00046B 85               [ 2]  870 	popw	x
      00046C 4D               [ 1]  871 	tnz	a
      00046D 27 F5            [ 1]  872 	jreq	00110$
                                    873 ;	user/ds1307.c: 258: I2C_GenerateSTART( ENABLE);
      00046F 4B 01            [ 1]  874 	push	#0x01
      000471 CDr00r00         [ 4]  875 	call	_I2C_GenerateSTART
      000474 84               [ 1]  876 	pop	a
                                    877 ;	user/ds1307.c: 259: while(!I2C_CheckEvent( I2C_EVENT_MASTER_MODE_SELECT));
      000475                        878 00113$:
      000475 4B 01            [ 1]  879 	push	#0x01
      000477 4B 03            [ 1]  880 	push	#0x03
      000479 CDr00r00         [ 4]  881 	call	_I2C_CheckEvent
      00047C 85               [ 2]  882 	popw	x
      00047D 4D               [ 1]  883 	tnz	a
      00047E 27 F5            [ 1]  884 	jreq	00113$
                                    885 ;	user/ds1307.c: 262: I2C_Send7bitAddress(0xD0,I2C_DIRECTION_RX);
      000480 4B 01            [ 1]  886 	push	#0x01
      000482 4B D0            [ 1]  887 	push	#0xd0
      000484 CDr00r00         [ 4]  888 	call	_I2C_Send7bitAddress
      000487 85               [ 2]  889 	popw	x
                                    890 ;	user/ds1307.c: 265: while(I2C_GetFlagStatus( I2C_FLAG_ADDRESSSENTMATCHED) == RESET);
      000488                        891 00116$:
      000488 4B 02            [ 1]  892 	push	#0x02
      00048A 4B 01            [ 1]  893 	push	#0x01
      00048C CDr00r00         [ 4]  894 	call	_I2C_GetFlagStatus
      00048F 85               [ 2]  895 	popw	x
      000490 4D               [ 1]  896 	tnz	a
      000491 27 F5            [ 1]  897 	jreq	00116$
                                    898 ;	user/ds1307.c: 268: I2C_AcknowledgeConfig(I2C_ACK_NONE);
      000493 4B 00            [ 1]  899 	push	#0x00
      000495 CDr00r00         [ 4]  900 	call	_I2C_AcknowledgeConfig
      000498 84               [ 1]  901 	pop	a
                                    902 ;	user/ds1307.c: 271: I2C->SR1;        I2C->SR3;
      000499 AE 52 17         [ 2]  903 	ldw	x, #0x5217
      00049C F6               [ 1]  904 	ld	a, (x)
      00049D AE 52 19         [ 2]  905 	ldw	x, #0x5219
      0004A0 F6               [ 1]  906 	ld	a, (x)
                                    907 ;	user/ds1307.c: 273: I2C_GenerateSTOP(ENABLE);
      0004A1 4B 01            [ 1]  908 	push	#0x01
      0004A3 CDr00r00         [ 4]  909 	call	_I2C_GenerateSTOP
      0004A6 84               [ 1]  910 	pop	a
                                    911 ;	user/ds1307.c: 276: while (I2C_GetFlagStatus( I2C_FLAG_RXNOTEMPTY) == RESET);
      0004A7                        912 00119$:
      0004A7 4B 40            [ 1]  913 	push	#0x40
      0004A9 4B 01            [ 1]  914 	push	#0x01
      0004AB CDr00r00         [ 4]  915 	call	_I2C_GetFlagStatus
      0004AE 85               [ 2]  916 	popw	x
      0004AF 4D               [ 1]  917 	tnz	a
      0004B0 27 F5            [ 1]  918 	jreq	00119$
                                    919 ;	user/ds1307.c: 279: data=I2C_ReceiveData();
      0004B2 CDr00r00         [ 4]  920 	call	_I2C_ReceiveData
      0004B5 6B 01            [ 1]  921 	ld	(0x01, sp), a
                                    922 ;	user/ds1307.c: 282: while(I2C->CR2 & I2C_CR2_STOP);
      0004B7                        923 00122$:
      0004B7 AE 52 11         [ 2]  924 	ldw	x, #0x5211
      0004BA F6               [ 1]  925 	ld	a, (x)
      0004BB A5 02            [ 1]  926 	bcp	a, #0x02
      0004BD 26 F8            [ 1]  927 	jrne	00122$
                                    928 ;	user/ds1307.c: 284: I2C_AcknowledgeConfig( I2C_ACK_CURR);
      0004BF 4B 01            [ 1]  929 	push	#0x01
      0004C1 CDr00r00         [ 4]  930 	call	_I2C_AcknowledgeConfig
      0004C4 84               [ 1]  931 	pop	a
                                    932 ;	user/ds1307.c: 285: return (data);
      0004C5 7B 01            [ 1]  933 	ld	a, (0x01, sp)
      0004C7 5B 01            [ 2]  934 	addw	sp, #1
      0004C9 81               [ 4]  935 	ret
                                    936 ;	user/ds1307.c: 287: unsigned char BCD2BIN(unsigned char data)
                                    937 ;	-----------------------------------------
                                    938 ;	 function BCD2BIN
                                    939 ;	-----------------------------------------
      0004CA                        940 _BCD2BIN:
      0004CA 88               [ 1]  941 	push	a
                                    942 ;	user/ds1307.c: 290: high=(data>>4)&0x0F;
      0004CB 7B 04            [ 1]  943 	ld	a, (0x04, sp)
      0004CD 4E               [ 1]  944 	swap	a
      0004CE A4 0F            [ 1]  945 	and	a, #0x0f
      0004D0 A4 0F            [ 1]  946 	and	a, #0x0f
      0004D2 97               [ 1]  947 	ld	xl, a
                                    948 ;	user/ds1307.c: 291: low=data&0x0F;
      0004D3 7B 04            [ 1]  949 	ld	a, (0x04, sp)
      0004D5 A4 0F            [ 1]  950 	and	a, #0x0f
      0004D7 6B 01            [ 1]  951 	ld	(0x01, sp), a
                                    952 ;	user/ds1307.c: 292: return ((high*10)+low);
      0004D9 A6 0A            [ 1]  953 	ld	a, #0x0a
      0004DB 42               [ 4]  954 	mul	x, a
      0004DC 9F               [ 1]  955 	ld	a, xl
      0004DD 1B 01            [ 1]  956 	add	a, (0x01, sp)
      0004DF 5B 01            [ 2]  957 	addw	sp, #1
      0004E1 81               [ 4]  958 	ret
                                    959 ;	user/ds1307.c: 294: unsigned char BIN2BCD(unsigned char data)
                                    960 ;	-----------------------------------------
                                    961 ;	 function BIN2BCD
                                    962 ;	-----------------------------------------
      0004E2                        963 _BIN2BCD:
      0004E2 88               [ 1]  964 	push	a
                                    965 ;	user/ds1307.c: 297: high=data/10;    high =(high<<4)&0xF0;
      0004E3 5F               [ 1]  966 	clrw	x
      0004E4 7B 04            [ 1]  967 	ld	a, (0x04, sp)
      0004E6 97               [ 1]  968 	ld	xl, a
      0004E7 A6 0A            [ 1]  969 	ld	a, #0x0a
      0004E9 62               [ 2]  970 	div	x, a
      0004EA 9F               [ 1]  971 	ld	a, xl
      0004EB 4E               [ 1]  972 	swap	a
      0004EC A4 F0            [ 1]  973 	and	a, #0xf0
      0004EE A4 F0            [ 1]  974 	and	a, #0xf0
      0004F0 6B 01            [ 1]  975 	ld	(0x01, sp), a
                                    976 ;	user/ds1307.c: 298: low=data%10;    low&=0x0F;
      0004F2 5F               [ 1]  977 	clrw	x
      0004F3 7B 04            [ 1]  978 	ld	a, (0x04, sp)
      0004F5 97               [ 1]  979 	ld	xl, a
      0004F6 A6 0A            [ 1]  980 	ld	a, #0x0a
      0004F8 62               [ 2]  981 	div	x, a
      0004F9 A4 0F            [ 1]  982 	and	a, #0x0f
                                    983 ;	user/ds1307.c: 299: return ((high)|low);
      0004FB 1A 01            [ 1]  984 	or	a, (0x01, sp)
      0004FD 5B 01            [ 2]  985 	addw	sp, #1
      0004FF 81               [ 4]  986 	ret
                                    987 	.area CODE
                                    988 	.area INITIALIZER
                                    989 	.area CABS (ABS)
